!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@pebula/ngrid"),require("rxjs"),require("rxjs/operators"),require("@angular/core"),require("@angular/cdk/bidi"),require("@angular/cdk/overlay"),require("@angular/cdk/portal"),require("@angular/common")):"function"==typeof define&&define.amd?define("@pebula/ngrid/overlay-panel",["exports","@pebula/ngrid","rxjs","rxjs/operators","@angular/core","@angular/cdk/bidi","@angular/cdk/overlay","@angular/cdk/portal","@angular/common"],r):r(((e=e||self).pebula=e.pebula||{},e.pebula.ngrid=e.pebula.ngrid||{},e.pebula.ngrid["overlay-panel"]={}),e.pebula.ngrid,e.rxjs,e.rxjs.operators,e.ng.core,e.ng.cdk.bidi,e.ng.cdk.overlay,e.ng.cdk.portal,e.ng.common)}(this,(function(e,r,t,o,n,i,a,l,c){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var s=function(e,r){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function u(e,r){function t(){this.constructor=e}s(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var p=function(){return(p=Object.assign||function(e){for(var r,t=1,o=arguments.length;t<o;t++)for(var n in r=arguments[t])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)};function f(e){var r="function"==typeof Symbol&&e[Symbol.iterator],t=0;return r?r.call(e):{next:function(){return e&&t>=e.length&&(e=void 0),{value:e&&e[t++],done:!e}}}}function d(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var o,n,i=t.call(e),a=[];try{for(;(void 0===r||r-- >0)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return a}var y=function(e){function r(r,t,o,n){var i=e.call(this)||this;return i.component=t,i.cfr=o,i.injector=n,i.kind="overlayPanels",i.projectContent=!1,i.name=r,i}return u(r,e),r.prototype.getFactory=function(e){return this.cfr.resolveComponentFactory(this.component)},r.prototype.onCreated=function(e,r){r.changeDetectorRef.markForCheck(),r.changeDetectorRef.detectChanges()},r}(r.PblNgridMultiComponentRegistry);var v=function(){function e(e,r){var n=this;this.overlayRef=e,this.data=r,this._closed$=new t.Subject,this.closed=this._closed$.asObservable(),this._closingActions(this,e).pipe(o.takeUntil(this.closed)).subscribe((function(){return n.close()}))}return e.prototype.close=function(){if(this._closed$){var e=this._closed$;this._closed$=void 0,e.next(),e.complete(),this.overlayRef.detach(),this.overlayRef.dispose()}},e.prototype._closingActions=function(e,r){var o=r.backdropClick(),n=r.detachments();return t.merge(o,n,e.closed)},e}();var g={hasBackdrop:!1,xPos:"center",yPos:"center",insetPos:!1},h=function(){function e(e,r){this._overlay=e,this._dir=r}return e.prototype.create=function(e){return new b(this._overlay,this._dir,e)},e.decorators=[{type:n.Injectable}],e.ctorParameters=function(){return[{type:a.Overlay},{type:i.Directionality}]},e}();var b=function(){function e(e,t,o){this._overlay=e,this._dir=t,this.grid=o;var i=r.PblNgridPluginController.find(o);this.injector=i.injector,this.vcRef=i.injector.get(n.ViewContainerRef),this._scrollStrategy=function(){return e.scrollStrategies.reposition()}}return e.prototype.openGridCell=function(e,r,t,o,i){var a,l=this.grid.columnApi.findColumn(r);if(!l)throw new Error("Could not find the column "+r);var c=0;switch(t){case"header":case"footer":a=t;break;default:"number"==typeof t&&(a="table",c=t)}if(!a)throw new Error('Invalid "rowRenderPosition" provided, use "header", "footer" or any number >= 0.');var s=l&&l.columnDef.queryCellElements(a)[c];if(!s)throw new Error("Could not find a cell for the column "+r+" at render index "+c);return this.open(e,new n.ElementRef(s),o,i)},e.prototype.open=function(e,t,o,n){o=Object.assign(p({},g),o||{});var i=this.findNamesExtension(e);if(!i)throw new Error("Could not find the overlay panel with the name "+e);var a=this._createOverlay(t,o),l=new v(a,n);if(this._setPosition(a.getConfig().positionStrategy,o),i instanceof r.PblNgridMultiTemplateRegistry){var c=this._getTemplatePortal(i.tRef,l),s=a.attach(c);s.markForCheck(),s.detectChanges()}else{var u=this._getComponentPortal(l,i),f=a.attach(u);i.onCreated(null,f)}return a.updatePosition(),l},e.prototype._createOverlay=function(e,r){var t=this._getOverlayConfig(e,r),o=this._overlay.create(t);return o.getConfig().hasBackdrop=!!r.hasBackdrop,o.keydownEvents().subscribe(),o},e.prototype._getOverlayConfig=function(e,r){var t=this._overlay.position().flexibleConnectedTo(e).withLockedPosition();return new a.OverlayConfig({positionStrategy:t,backdropClass:r.backdropClass||"cdk-overlay-transparent-backdrop",scrollStrategy:this._scrollStrategy(),direction:this._dir})},e.prototype._getTemplatePortal=function(e,r){var t={grid:this.grid,ref:r};return new l.TemplatePortal(e,this.vcRef,t)},e.prototype._getComponentPortal=function(e,r){var t=n.Injector.create({providers:[{provide:v,useValue:e}],parent:r.injector||this.injector});return new l.ComponentPortal(r.component,this.vcRef,t,r.cfr||null)},e.prototype._setPosition=function(e,r){var t=d("center"===r.xPos?["center","center"]:"before"===r.xPos?["end","start"]:["start","end"],2),o=t[0],n=t[1],i=d("center"===r.yPos?["center","center"]:"above"===r.yPos?["bottom","top"]:["top","bottom"],2),a=i[0],l=i[1],c=d([a,l],2),s=c[0],u=c[1],p=d([o,n],2),f=p[0],y=p[1];r.insetPos||("center"!==a&&(s="top"===a?"bottom":"top"),"center"!==l&&(u="top"===l?"bottom":"top")),e.withPositions([{originX:o,originY:s,overlayX:f,overlayY:a,offsetY:0},{originX:n,originY:s,overlayX:y,overlayY:a,offsetY:0},{originX:o,originY:u,overlayX:f,overlayY:l,offsetY:-0},{originX:n,originY:u,overlayX:y,overlayY:l,offsetY:-0}])},e.prototype.findNamesExtension=function(e){var r;return this.grid.registry.forMulti("overlayPanels",(function(t){var o,n;try{for(var i=f(t),a=i.next();!a.done;a=i.next()){var l=a.value;if(l.name===e)return r=l,!0}}catch(e){o={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}})),r},e}();var m=function(e){function t(r,t){var o=e.call(this,r,t)||this;return o.kind="overlayPanels",o}return u(t,e),t.decorators=[{type:n.Directive,args:[{selector:"[pblNgridOverlayPanelDef]"}]}],t.ctorParameters=function(){return[{type:n.TemplateRef},{type:r.PblNgridRegistryService}]},t.propDecorators={name:[{type:n.Input,args:["pblNgridOverlayPanelDef"]}]},t}(r.PblNgridMultiTemplateRegistry);var P=function(){function e(){}return e.decorators=[{type:n.NgModule,args:[{imports:[c.CommonModule,a.OverlayModule,i.BidiModule],declarations:[m],exports:[m],providers:[h]}]}],e}();e.PblNgridOverlayPanel=b,e.PblNgridOverlayPanelComponentExtension=y,e.PblNgridOverlayPanelDef=m,e.PblNgridOverlayPanelFactory=h,e.PblNgridOverlayPanelModule=P,e.PblNgridOverlayPanelRef=v,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pebula-ngrid-overlay-panel.umd.min.js.map