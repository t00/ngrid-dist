!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("rxjs"),require("@angular/core"),require("@angular/cdk/table"),require("resize-observer-polyfill"),require("rxjs/operators"),require("@angular/cdk/coercion"),require("@angular/cdk/collections"),require("@angular/cdk/drag-drop"),require("@angular/common"),require("@angular/cdk/platform"),require("@angular/cdk/bidi"),require("@angular/cdk/scrolling"),require("@angular/cdk-experimental/scrolling")):"function"==typeof define&&define.amd?define("@pebula/ngrid",["exports","rxjs","@angular/core","@angular/cdk/table","resize-observer-polyfill","rxjs/operators","@angular/cdk/coercion","@angular/cdk/collections","@angular/cdk/drag-drop","@angular/common","@angular/cdk/platform","@angular/cdk/bidi","@angular/cdk/scrolling","@angular/cdk-experimental/scrolling"],t):t(((e=e||self).pebula=e.pebula||{},e.pebula.ngrid={}),e.rxjs,e.ng.core,e.ng.cdk.table,e.ResizeObserver,e.rxjs.operators,e.ng.cdk.coercion,e.ng.cdk.collections,e.ng.cdk.dragDrop,e.ng.common,e.ng.cdk.platform,e.ng.cdk.bidi,e.ng.cdk.scrolling,e.ng.cdkExperimental.scrolling)}(this,(function(e,t,r,n,i,o,a,s,l,c,u,d,h,p){"use strict";i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i;
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var f=function(e,t){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function g(e,t){function r(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var y=function(){return(y=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function b(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}var w={showHeader:!0,showFooter:!1,noFiller:!1},C=new r.InjectionToken("PEB_NGRID_CONFIG"),_=function(){function e(e){var t,r;if(this.config=new Map,this.configNotify=new Map,e)try{for(var n=v(Object.keys(e)),i=n.next();!i.done;i=n.next()){var o=i.value;this.config.set(o,e[o])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}var a=this.config.get("table")||{};this.config.set("table",y(y({},w),a))}return e.prototype.has=function(e){return this.config.has(e)},e.prototype.get=function(e,t){return this.config.get(e)||t},e.prototype.set=function(e,t){var r=this.get(e);t=Object.assign({},t),Object.freeze(t),this.config.set(e,t),this.notify(e,t,r)},e.prototype.onUpdate=function(e){return this.getGetNotifier(e)},e.prototype.getGetNotifier=function(e){var r=this.configNotify.get(e);return r||this.configNotify.set(e,r=new t.ReplaySubject(1)),r},e.prototype.notify=function(e,t,r){this.getGetNotifier(e).next({curr:t,prev:r})},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:r.Optional},{type:r.Inject,args:[C]}]}]},e.ɵprov=r.ɵɵdefineInjectable({factory:function(){return new e(r.ɵɵinject(C,8))},token:e,providedIn:"root"}),e}();var x=new Map;var R=new WeakMap,S=function(){function e(){this._events=new t.Subject,this.events=this._events.asObservable()}return e.create=function(t,r,n){if(R.has(t))throw new Error("Table is already registered for extensions.");var i=new e;return R.set(t,i),i.grid=t,i.injector=r,i.extApi=n,i.controller=new k(i),i},e.prototype.emitEvent=function(e){this._events.next(e)},e.prototype.destroy=function(){if(!R.has(this.grid))throw new Error("Table is not registered.");this._events.complete(),R.delete(this.grid)},e}();var k=function(){function e(t){this.context=t,this.plugins=new Map,this.grid=t.grid,this.extApi=t.extApi,this.events=t.events,e.created$.next({table:this.grid,controller:this})}return Object.defineProperty(e.prototype,"injector",{get:function(){return this.context.injector},enumerable:!0,configurable:!0}),e.find=function(e){var t=R.get(e);if(t)return t.controller},e.prototype.hasPlugin=function(e){return this.plugins.has(e)},e.prototype.getPlugin=function(e){return this.plugins.get(e)},e.prototype.setPlugin=function(e,t){var r=this;if(!x.has(e))throw new Error("Unknown plugin "+e+".");if(this.plugins.has(e))throw new Error("Plugin "+e+" is not registered for this table.");return this.plugins.set(e,t),function(t){return r.grid===t&&r.plugins.delete(e)}},e.prototype.createPlugin=function(e){if(!x.has(e))throw new Error("Unknown plugin "+e+".");var t=x.get(e),r=t.factory;if(!r)throw new Error("Invalid plugin configuration for "+e+", no factory metadata.");if("function"!=typeof t.target[r])throw new Error("Invalid plugin configuration for "+e+", factory metadata does not point to a function.");return t.target[r](this.grid,this.context.injector)},e.created$=new t.Subject,e.created=e.created$.asObservable(),e}();var D=new r.InjectionToken("PBL_NGRID_EXTERNAL_API");function O(e,t){var r,n;if(t.path)try{for(var i=v(t.path),o=i.next();!o.done;o=i.next()){if(!(e=e[o.value]))return}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return e[t.prop]}function P(e,t,r){var n,i,o,a,s,l,c=e.defaultColumnWidth,u="calc("+c.pct+"% - "+c.px+"px)";try{for(var d=v(t),h=d.next();!h.done;h=d.next()){(b=h.value).setDefaultWidth(u),b.updateWidth()}}catch(e){n={error:e}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}try{for(var p=v(r),f=p.next();!f.done;f=p.next()){var g=f.value;try{for(var y=(s=void 0,v([g.header,g.footer])),m=y.next();!m.done;m=y.next()){var b;(b=m.value)&&b.updateWidth("")}}catch(e){s={error:e}}finally{try{m&&!m.done&&(l=y.return)&&l.call(y)}finally{if(s)throw s.error}}}}catch(e){o={error:e}}finally{try{f&&!f.done&&(a=p.return)&&a.call(p)}finally{if(o)throw o.error}}}function I(e,t){return I.pipe(e,t)}function E(e,t){if(Array.isArray(t))return t.map((function(t){return A(e,t)}));if("function"==typeof t){var r=e.findIndex(t);return r>-1&&(e.splice(r,1),!0)}return A(e,t)}function A(e,t){var r=e.indexOf(t);return r>-1&&(e.splice(r,1),!0)}(function(e){var r={},n=new WeakMap;function i(e,r){void 0===r&&(r=!1);var i=n.get(e);return i||!0!==r||n.set(e,i=new t.Subject),i}function a(e){var t=i(e);t&&(t.next(r),t.complete(),n.delete(e))}e.kill=function(e){for(var t,r,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(0===n.length)a(e);else{var s=i(e);if(s)try{for(var l=v(n),c=l.next();!c.done;c=l.next()){var u=c.value;s.next(u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}}},e.pipe=function(e,t){return function(n){return n.pipe(o.takeUntil(i(e,!0).pipe(o.filter((function(e){return e===r||t&&e===t})))))}}})(I||(I={}));var T=function(e,t,r,n){return t&&t.toString().toLowerCase().includes(e)};function F(e,t,r){if(!t||!t.order)return r;var n="function"==typeof t.sortFn?t.sortFn:"function"==typeof e.sort?e.sort:j;return e&&r?n(e,t,r.slice()):r||[]}function j(e,t,r){return r.sort((function(r,n){var i=e.getValue(r),o=e.getValue(n);return((i=isNaN(+i)?i:+i)<(o=isNaN(+o)?o:+o)?-1:i===o?0:1)*("asc"===t.order?1:-1)}))}var W=Object.freeze({}),M={filter:function(e,t){return e.filter===t.filter&&e.type==t.type},sort:function(e,t){if(e.column===t.column){var r=e.sort||{},n=t.sort||{};return r.order===n.order&&r.sortFn===n.sortFn}},data:function(e,t){return e===t}};function V(e,t,r){var n,i;if("pagination"===e){var o=t||{},a=r.pagination,s=Object.keys(o).filter((function(e){return a[e]!=o[e][1]&&"total"!==e})),l={changed:s.length>0,page:H(a.page),perPage:H(a.perPage)};if(l.changed)try{for(var c=v(s),u=c.next();!u.done;u=c.next()){var d=u.value;l[d].changed=!0,l[d].prev=o[d][0],l[d].curr=a[d]=o[d][1]}}catch(e){n={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}return l}t=t||W;var h=r[e];return t===h||t!==W&&h!==W&&(0,M[e])(h,t)?H(h):(r[e]=t,{changed:!0,prev:h,curr:t})}function H(e){return{changed:!1,prev:e,curr:e}}var N=["sort","filter","pagination"],z=b(N,["data"]),L={},$={filter:W,sort:W,pagination:{},data:W},B=function(){function e(e,t){this.sourceFactory=e,this.config=Object.assign({},t||{}),this.initStreams()}return e.prototype.dispose=function(){this._refresh$.complete(),this._onSourceChange$.complete()},e.prototype.refresh=function(e){this._refresh$.next({data:e})},e.prototype.clearCache=function(e){if(e in this.cache){var t=this.cache[e];return this.cache[e]=$[e],t}return null},e.prototype.setPaginator=function(e){this.paginator=e},e.prototype.updateProcessingLogic=function(e,r,n,i){var a=this;void 0===i&&(i={});var s=-1,l=function(e){return-1===s||e.changed};this._lastSource=void 0,this.cache=y(y({},$),i);var c=[e.pipe(o.map((function(e){return V("filter",e,a.cache)})),o.filter(l)),r.pipe(o.filter((function(e){return!0!==e.skipUpdate})),o.map((function(e){return V("sort",e,a.cache)})),o.filter(l)),n.pipe(o.map((function(e){return V("pagination",e,a.cache)})),o.filter(l)),this._refresh$.pipe(o.map((function(e){return{changed:(t=V("data",e,a.cache)).changed,prev:t.prev.data,curr:t.hasOwnProperty("curr")?t.curr.data:t.prev.data};var t})),o.filter(l))],u=N.some((function(e){return!!a.config[e]}));return t.combineLatest(c[0],c[1],c[2],c[3]).pipe(o.debounceTime(0),o.switchMap((function(e){var r=m(e,4),n=r[0],i=r[1],l=r[2],c=r[3],d={filter:n,sort:i,pagination:l,data:c,isInitial:0===++s,updateTotalLength:function(e){a.paginator&&(a.paginator.total=e)}};return c.changed||u&&N.some((function(e){return!!a.config[e]&&d[e].changed}))?a.runHandle(d).pipe(o.tap((function(){return d.data.changed=!0})),o.map((function(e){return{event:d,data:e}}))):t.of({event:d,data:a._lastSource})})),o.map((function(e){var t,r,n,i,o=a.config,s=e.event,l={};try{for(var c=v(N),u=c.next();!u.done;u=c.next()){var d=u.value;o[d]||!s.isInitial&&!s[d].changed||(l[d]=!0)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}s.data.changed&&(a._lastSource=e.data,o.sort?a._lastSortedSource=a._lastSource:(l.sort=!0,l.filter=!0),o.filter?a._lastFilteredSource=a._lastSource:l.filter=!0),o.pagination||!l.sort&&!l.filter||(l.pagination=!0),l.sort&&(a._lastSortedSource=a.applySort(a._lastSource,s.sort.curr||s.sort.prev));var h=a._lastSortedSource;(l.filter||s.filter.curr&&s.filter.curr.filter)&&(h=a._lastFilteredSource=a.applyFilter(h,s.filter.curr||s.filter.prev)),l.pagination&&(h=a.applyPagination(h));var p=y({},s);try{for(var f=v(z),g=f.next();!g.done;g=f.next()){var m=g.value;p[m]="pagination"===m?JSON.parse(JSON.stringify(s[m])):y({},s[m]),s[m].changed=!1}}catch(e){n={error:e}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}return s.pagination.page.changed=s.pagination.perPage.changed=!1,{event:p,data:h,sorted:a._lastSortedSource,filtered:a._lastFilteredSource}})))},e.prototype.applyFilter=function(e,t){return e=function(e,t){if(!t||!e||0===e.length)return e;var r=t.columns;if("predicate"===t.type){var n=t.filter;return e.filter((function(e){return n(e,r)}))}if("value"===t.type){var i="function"==typeof t.filter.toLowerCase?t.filter.toLowerCase():t.filter;return e.filter((function(e){return r.some((function(r){return(r.filter||T)(r.filter?t.filter:i,r.getValue(e),e,r)}))}))}return e}(e,t),this.config.pagination||this.resetPagination(e.length),e},e.prototype.applySort=function(e,t){return F(t.column,t.sort,e)},e.prototype.applyPagination=function(e){if(this.paginator){var t=this.paginator.range;return e.slice(t[0],t[1])}return e},e.prototype.resetPagination=function(e){this.paginator&&(this.paginator.total=e,this.paginator.page=e>0?1:0)},e.prototype.initStreams=function(){this._onSourceChange$=new t.Subject,this.onSourceChanged=this._onSourceChange$.pipe(o.filter((function(e){return e!==L}))),this.onSourceChanging=this._onSourceChange$.pipe(o.filter((function(e){return e===L}))),this._refresh$=new t.Subject,this._lastSource=void 0},e.prototype.runHandle=function(e){var r=this;this._onSourceChange$.next(L);var n=this.sourceFactory(e);return!1===n?t.of(!1).pipe(o.filter((function(){return!1}))):(t.isObservable(n)?n:Array.isArray(n)?t.of(n):t.from(n)).pipe(o.observeOn(t.asapScheduler,0),o.map((function(e){return Array.isArray(e)?e:[]})),o.tap((function(e){return r._onSourceChange$.next(e)})))},e}();var G=function(){function e(){this.kind="token",this._perPage=10,this._total=0,this.onChange$=new t.BehaviorSubject({page:[null,null]}),this.onChange=this.onChange$.asObservable(),this.reset()}return Object.defineProperty(e.prototype,"perPage",{get:function(){return this._perPage},set:function(e){if(e<1)throw new Error("Invalid total size value "+e);if(this._perPage!==e){var t={perPage:[this._perPage,this._perPage=e]};this.emit(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this._page},set:function(e){if(this._page!==e){var t=this._tokens.indexOf(e);if(-1===t)throw new Error("Invalid page token "+e);this._cursor=t;var r=this._page;this._page=e,this.emit({page:[r,e]})}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"total",{get:function(){return this._total},set:function(e){var t={total:[this._total,this._total=e]};this.emit(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalPages",{get:function(){return this._tokens.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){if(!this._range){var e=this._cursor*this.perPage,t=Math.min(this._total,e+this.perPage);this._range=this.noCacheMode?[0,t-e]:[e,t]}return this._range},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._tokens=[null],this._cursor=0,this._total=0,this.page=null},e.prototype.canMove=function(e){return this._tokens.indexOf(e)>-1},e.prototype.hasNext=function(){return this._cursor<this._tokens.length-1},e.prototype.hasPrev=function(){return this._cursor>0},e.prototype.move=function(e){this.page=e},e.prototype.nextPage=function(){this.page=this._tokens[++this._cursor]},e.prototype.prevPage=function(){this.page=this._tokens[--this._cursor]},e.prototype.addNext=function(e){var t=this._cursor+1;this._tokens[t]!==e&&(this._tokens[t]=e,this._tokens.splice(t+1))},e.prototype.emit=function(e){var t=this;this._range=void 0,this.queuedChanges?Object.assign(this.queuedChanges,e):(this.queuedChanges=e,setTimeout((function(){t.queuedChanges=void 0,t.onChange$.next(e)})))},e}();var q=function(){function e(){this.kind="pageNumber",this._total=0,this._perPage=10,this._page=1,this._totalPages=0,this.onChange$=new t.BehaviorSubject({page:[null,1]}),this.onChange=this.onChange$.asObservable()}return Object.defineProperty(e.prototype,"perPage",{get:function(){return this._perPage},set:function(e){if(e<1)throw new Error("Invalid total size value "+e);if(this._perPage!==e){var t={perPage:[this._perPage,this._perPage=e]},r=this._page;this.calcPages(),r!==this._page&&(t.page=[r,this._page]),this.emit(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this._page},set:function(e){if(e<0||e>this._totalPages)throw new Error("Invalid page index "+e);if(this._page!==e){var t=this._page;this._page=e,this.emit({page:[t,e]})}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"total",{get:function(){return this._total},set:function(e){if(e<0)throw new Error("Invalid total size value "+e);if(this._total!==e){var t={total:[this._total,this._total=e]},r=this._page;this.calcPages(),r!==this._page&&(t.page=[r,this._page]),this.emit(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalPages",{get:function(){return this._totalPages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){if(!this._range){var e=(this.page-1)*this.perPage,t=Math.min(this._total,e+this.perPage);this._range=this.noCacheMode?[0,t-e]:[e,t]}return this._range},enumerable:!0,configurable:!0}),e.prototype.canMove=function(e){var t=this._page+e;return t>=1&&t<=this.totalPages},e.prototype.hasNext=function(){return this.canMove(1)},e.prototype.hasPrev=function(){return this.canMove(-1)},e.prototype.move=function(e){this.page=this._page+e},e.prototype.nextPage=function(){this.move(1)},e.prototype.prevPage=function(){this.move(-1)},e.prototype.reset=function(){this.page=1},e.prototype.calcPages=function(){this._totalPages=Math.ceil(this._total/this.perPage),this._totalPages>0&&this._page>this._totalPages&&(this.page=this._totalPages)},e.prototype.emit=function(e){var t=this;this._range=void 0,this.queuedChanges?Object.assign(this.queuedChanges,e):(this.queuedChanges=e,setTimeout((function(){t.queuedChanges=void 0,t.onChange$.next(e)})))},e}();var U={};var Z=function(e){function r(r,n){var i=e.call(this)||this;return i._selection=new s.SelectionModel(!0,[]),i._tableConnectionChange$=new t.Subject,i._onRenderDataChanging=new t.Subject,i._renderData$=new t.BehaviorSubject([]),i._filter$=new t.BehaviorSubject(void 0),i._sort$=new t.BehaviorSubject({column:null,sort:null,skipUpdate:!1}),i._onError$=new t.Subject,n=n||{},i.adapter=r,i.onSourceChanging=i._adapter.onSourceChanging,i.onSourceChanged=i.adapter.onSourceChanged.pipe(o.observeOn(t.asapScheduler,0),o.mapTo(void 0)),i.onRenderDataChanging=i._onRenderDataChanging.asObservable(),i.onRenderedDataChanged=i._renderData$.pipe(o.skip(1),o.mapTo(void 0)),i.onError=i._onError$.asObservable(),i.tableConnectionChange=i._tableConnectionChange$.asObservable(),i.keepAlive=n.keepAlive||!1,i.skipInitial=n.skipInitial||!1,i.sortChange=i._sort$.asObservable(),i}return g(r,e),Object.defineProperty(r.prototype,"pagination",{get:function(){return this._pagination},set:function(e){if(this._pagination!==e){switch(this._pagination=e,e){case"pageNumber":this._paginator=new q;break;case"token":this._paginator=new G;break;default:this._paginator=void 0}this._adapter&&this._adapter.setPaginator(this._paginator)}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"adapter",{get:function(){return this._adapter},set:function(e){this._adapter!==e&&(this._adapter=e,this.pagination&&this._adapter.setPaginator(this._paginator))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderedRows",{get:function(){return this._renderData$.value||[]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderStart",{get:function(){return this._lastRange?this._lastRange.start:0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderLength",{get:function(){return this._renderData$.value.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderedData",{get:function(){return this._renderData$.value||[]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sortedData",{get:function(){return this._lastAdapterEvent&&this._lastAdapterEvent.sorted||[]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"filteredData",{get:function(){return this._lastAdapterEvent&&this._lastAdapterEvent.filtered||[]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"filter",{get:function(){return this._filter$.value},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sort",{get:function(){return this._sort$.value},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"paginator",{get:function(){return this._paginator},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.source.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"source",{get:function(){return this._source||[]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selection",{get:function(){return this._selection},enumerable:!0,configurable:!0}),r.prototype.refresh=function(e){this._tableConnected?this._adapter.refresh(e):this._lastRefresh=e},r.prototype.setFilter=function(e,t){if(e&&"function"!=typeof e&&(!t||0===t.length))throw new Error("Invalid filter definitions, columns are mandatory when using a single value input.");this._filter$.next(function(e,t){return void 0===e?void 0:{columns:t,type:"function"==typeof e?"predicate":"value",filter:e}}(e,t||[]))},r.prototype.syncFilter=function(){var e=this._adapter.clearCache("filter");e&&this.setFilter(e.filter,e.columns)},r.prototype.setSort=function(e,t,r){void 0===r&&(r=!1),e&&"boolean"!=typeof e?this._sort$.next({column:e,sort:t,skipUpdate:r}):this._sort$.next({column:null,sort:{},skipUpdate:!!e})},r.prototype.dispose=function(){this._disposed||(I.kill(this),this._adapter.dispose(),this._onRenderDataChanging.complete(),this._renderData$.complete(),this._filter$.complete(),this._sort$.complete(),this._onError$.complete(),this._disposed=!0)},r.prototype.disconnect=function(e){this._lastRefresh=void 0,this._tableConnectionChange$.next(this._tableConnected=!1),!1===this.keepAlive&&this.dispose()},r.prototype.connect=function(e){if(this._disposed)throw new Error("PblDataSource is disposed. Use `keepAlive` if you move datasource between tables.");return this._tableConnected=!0,this._updateProcessingLogic(e),this._tableConnectionChange$.next(this._tableConnected),this._renderData$},r.prototype.moveItem=function(e,t,r){if(void 0===r&&(r=!1),!0!==r&&this._lastRange&&(e=this._lastRange.start+e,t=this._lastRange.start+t),this.length>0){l.moveItemInArray(this._source,e,t);var n=this._lastRange?this._source.slice(this._lastRange.start,this._lastRange.end):this._source;this._renderData$.next(n)}},r.prototype._updateProcessingLogic=function(e){var r=this,n={filter:this.filter,sort:this.sort},i=this._paginator;i&&(n.pagination={page:i.page,perPage:i.perPage});var a=this._adapter.updateProcessingLogic(this._filter$,this._sort$,i?i.onChange:t.of(void 0),n);I.kill(this,U);var s,l,c=function(e,t){return t.slice(e.start,e.end)};e.viewChange.pipe(I(this,U)).subscribe((function(e){r._lastRange&&r._lastRange.start===e.start&&r._lastRange.end===e.end||(r._lastRange=e,s||e&&l&&l.length&&r._renderData$.next(c(r._lastRange,l)))})),a.pipe(I(this,U),o.tap((function(e){l=e.data,s=!0,r._onRenderDataChanging.next(r._lastAdapterEvent=e)}))).subscribe((function(e){var t=e.data;r._lastRange&&t&&t.length&&(t=c(r._lastRange,t)),r._renderData$.next(t),s=!1}),(function(e){r._onError$.next(e)})),this._adapter.onSourceChanged.pipe(I(this,U)).subscribe((function(e){return r._source=e||[]})),void 0!==this._lastRefresh?(this._adapter.refresh(this._lastRefresh),this._lastRefresh=void 0):this.skipInitial||this.refresh()},r}(n.DataSource);var Y=function(){function e(){this._adapter={},this._dsOptions={}}return e.prototype.onTrigger=function(e){return this._adapter.onTrigger=e,this},e.prototype.setCustomTriggers=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(0===r.length)this._adapter.customTriggers=!1;else{var i=this._adapter.customTriggers={};try{for(var o=v(r),a=o.next();!a.done;a=o.next()){var s=a.value;i[s]=!0}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}}return this},e.prototype.skipInitialTrigger=function(){return this._dsOptions.skipInitial=!0,this},e.prototype.keepAlive=function(){return this._dsOptions.keepAlive=!0,this},e.prototype.onCreated=function(e){return this._onCreated=e,this},e.prototype.create=function(){var e=this._adapter,t=new B(e.onTrigger,e.customTriggers||!1),r=new Z(t,this._dsOptions);return this._onCreated&&this._onCreated(r),r},e}();function K(){return new Y}var J=/((?:\d*\.)?\d+)(%|px)$/;function X(e){var t=J.exec(e);if(t)return{value:Number(t[1]),type:t[2]}}function Q(e,t){["id","label","css","minWidth","width","maxWidth","type"].forEach((function(r){return r in e&&(t[r]=e[r])})),e.data&&(t.data=Object.assign(t.data||{},e.data))}var ee=Symbol("PblMetaColumn"),te=["kind","rowIndex"];function re(e){return e instanceof ne||e&&!0===e[ee]}var ne=function(){function e(e){var t,r;this.data={},this.defaultWidth="",this[ee]=!0,Q(e,this);try{for(var n=v(te),i=n.next();!i.done;i=n.next()){var o=i.value;o in e&&(this[o]=e[o])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}re(e)||"string"==typeof e.type&&(this.type={name:e.type})}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(e){if(e!==this._width){this._parsedWidth=X(this._width=e);var t=this._parsedWidth&&"px"===this._parsedWidth.type;Object.defineProperty(this,"isFixedWidth",{value:t,configurable:!0})}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parsedWidth",{get:function(){return this._parsedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnDef",{get:function(){return this._columnDef},enumerable:!0,configurable:!0}),e.extendProperty=function(e){-1===te.indexOf(e)&&te.push(e)},e.prototype.attach=function(e){this.detach(),this._columnDef=e,this.columnDef.updateWidth(this.width||this.defaultWidth,"attach")},e.prototype.detach=function(){this._columnDef=void 0},e.prototype.updateWidth=function(e){this.defaultWidth=e||"",this.columnDef&&this.columnDef.updateWidth(this.width||e,"update")},e}();var ie=Symbol("PblColumnGroup"),oe=[];function ae(e){return e instanceof ce||e&&!0===e[ie]}function se(e){return"string"==typeof e?e:e.id}var le=function(){function e(){this.store=new Map,this._all=[]}return Object.defineProperty(e.prototype,"all",{get:function(){return this._all},enumerable:!0,configurable:!0}),e.prototype.attach=function(e,t){var r=this._find(e);return!!r&&(r.activeColumns.add(se(t)),!0)},e.prototype.detach=function(e,t){var r=this._find(e);return!!r&&r.activeColumns.delete(se(t))},e.prototype.findGhosts=function(){return Array.from(this.store.values()).filter((function(e){return 0===e.activeColumns.size})).map((function(e){return e.group}))},e.prototype.add=function(e){this.store.set(e.id,{group:e,activeColumns:new Set}),this.updateAll()},e.prototype.remove=function(e){var t=this.find(e);return!(!t||!this.store.delete(t.id))&&(this.updateAll(),!0)},e.prototype.find=function(e){var t=this._find(e);if(t)return t.group},e.prototype.clone=function(){var t=new e;return t.store=new Map(this.store),t.updateAll(),t},e.prototype._find=function(e){return this.store.get(se(e))},e.prototype.updateAll=function(){this._all=Array.from(this.store.values()).map((function(e){return e.group}))},e}();var ce=function(e){function t(t,r,n){var i,o,a,s;void 0===n&&(n=!1);var l=e.call(this,ae(t)?t:y({id:"group-"+t.prop+"-span-"+t.span+"-row-"+t.rowIndex,kind:"header"},t))||this;l.placeholder=n,l[ie]=!0,l.prop=t.prop,l.span=t.span,l.columns=r;try{for(var c=v(r),u=c.next();!u.done;u=c.next()){u.value.markInGroup(l)}}catch(e){i={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}try{for(var d=v(oe),h=d.next();!h.done;h=d.next()){var p=h.value;p in t&&(l[p]=t[p])}}catch(e){a={error:e}}finally{try{h&&!h.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return l}return g(t,e),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.columns.some((function(e){return!e.hidden}))},enumerable:!0,configurable:!0}),t.extendProperty=function(e){-1===oe.indexOf(e)&&oe.push(e)},t.prototype.createSlave=function(e){void 0===e&&(e=[]);var r=new t(this,e);return r.id+="-slave"+Date.now(),r.slaveOf=this,r.template=this.template,r},t.prototype.replace=function(e){var t=e.id,r=this.columns.findIndex((function(e){return e.id===t}));return r>-1&&(this.columns.splice(r,1,e),!0)},t}(ne);var ue=Symbol("PblColumn"),de=["pIndex","transform","filter","sort","alias","headerType","footerType","pin"];function he(e){return e instanceof pe||e&&!0===e[ue]}var pe=function(){function e(e,t){var r,n,i,o;if(this.data={},this.defaultWidth="",this._groups=new Set,this[ue]=!0,he(e)){Q(e,this),this.prop=e.prop,this.path=e.path,this.orgProp=e.orgProp,this.groupStore=t||e.groupStore,this._groups=new Set(e._groups);try{for(var a=v(Array.from(e._groups.values())),s=a.next();!s.done;s=a.next()){var l=s.value,c=this.groupStore.find(l);c&&(this.markInGroup(c),c.replace(this))}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}}else{var u=e.path||e.prop.split("."),d=e.path?e.prop:u.pop();(e=Object.create(e)).id=e.id||e.prop||e.label,e.label="label"in e?e.label:d,"string"==typeof e.type&&(e.type={name:e.type}),"string"==typeof e.headerType&&(e.headerType={name:e.headerType}),"string"==typeof e.footerType&&(e.footerType={name:e.footerType}),Q(e,this),this.groupStore=t||new le,this.prop=d,this.orgProp=e.prop,u.length&&(this.path=u)}try{for(var h=v(de),p=h.next();!p.done;p=h.next()){(d=p.value)in e&&(this[d]=e[d])}}catch(e){i={error:e}}finally{try{p&&!p.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(e){if(e!==this._width){this._parsedWidth=X(this._width=e);var t=this._parsedWidth&&"px"===this._parsedWidth.type;Object.defineProperty(this,"isFixedWidth",{value:t,configurable:!0})}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parsedWidth",{get:function(){return this._parsedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortAlias",{get:function(){return this.alias},set:function(e){this.alias=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnDef",{get:function(){return this._columnDef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groups",{get:function(){return Array.from(this._groups.values())},enumerable:!0,configurable:!0}),e.extendProperty=function(e){-1===de.indexOf(e)&&de.push(e)},e.prototype.attach=function(e){this.detach(),this._columnDef=e,this.defaultWidth&&this.columnDef.updateWidth(this.width||this.defaultWidth,"attach")},e.prototype.detach=function(){this._columnDef=void 0},e.prototype.setDefaultWidth=function(e){this.defaultWidth=e},e.prototype.updateWidth=function(e){e&&(this.width=e);var t=this.columnDef;t&&t.updateWidth(this.width||this.defaultWidth||"","update")},e.prototype.getValue=function(e){return this.transform?this.transform(O(e,this),e,this):O(e,this)},e.prototype.setValue=function(e,t){return function(e,t,r){var n,i;if(t.path)try{for(var o=v(t.path),a=o.next();!a.done;a=o.next()){if(!(e=e[a.value]))return}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}e[t.prop]=r}(e,this,t)},e.prototype.markInGroup=function(e){this.groupStore.attach(e,this),this._groups.add(e.id)},e.prototype.markNotInGroup=function(e){return this.groupStore.detach(e,this),this._groups.delete(e.id)},e.prototype.isInGroup=function(e){return this._groups.has(e.id)},e.prototype.getGroupOfRow=function(e){var t,r,n=this.groups;try{for(var i=v(n),o=i.next();!o.done;o=i.next()){var a=o.value,s=this.groupStore.find(a);if(s&&s.rowIndex===e)return s}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}},e.prototype.groupLogic=function(e,t){var r=m(e,3),n=r[0],i=r[1],o=r[2];if(i===n)return i;if(t){if(n&&i===n.slaveOf)return n;if(o&&i===o.slaveOf)return o;var a=i.createSlave([this]);if(this.groupStore.add(a),i.placeholder){var s=n&&n.placeholder,l=o&&o.slaveOf&&o.placeholder,c=s?n:l?o:void 0;if(c)return c}return a}if(i.slaveOf&&n){if(i.slaveOf===n)return i.slaveOf;if(i.slaveOf===n.slaveOf)return n}else if(i.slaveOf&&o&&i.slaveOf===o)return i.slaveOf;return i},e.prototype.checkMaxWidthLock=function(e){if(e===this.maxWidth){if(!this.maxWidthLock)return this.maxWidthLock=!0,!0}else if(this.maxWidthLock)return this.maxWidthLock=!1,!0;return!1},e}();var fe=function(){function e(){this._raw={table:{cols:[]},header:[],footer:[],headerGroup:[]},this._defaults={table:{},header:{},footer:{}},this._currentHeaderRow=0,this._currentFooterRow=0}return Object.defineProperty(e.prototype,"currentHeaderRow",{get:function(){return this._currentHeaderRow},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentFooterRow",{get:function(){return this._currentFooterRow},enumerable:!0,configurable:!0}),e.fromDefinitionSet=function(t){var r=new e;return Object.assign(r._raw,t),r},e.prototype.build=function(){var e=this,t=this._defaults,r=this._raw,n=new le,i={header:r.table.header,footer:r.table.footer,cols:r.table.cols.map((function(e){return new pe(y(y({},t.table),e),n)}))},o=r.header.map((function(e){return{rowIndex:e.rowIndex,rowClassName:e.rowClassName,type:e.type||"fixed",cols:e.cols.map((function(e){return new ne(y(y({},t.header),e))}))}})),a=r.footer.map((function(e){return{rowIndex:e.rowIndex,rowClassName:e.rowClassName,type:e.type||"fixed",cols:e.cols.map((function(e){return new ne(y(y({},t.footer),e))}))}})),s=r.headerGroup.map((function(t){return{rowIndex:t.rowIndex,rowClassName:t.rowClassName,type:t.type||"fixed",cols:e.buildHeaderGroups(t.rowIndex,t.cols,i.cols).map((function(e){return n.add(e),e}))}}));return{groupStore:n,table:i,header:o,footer:a,headerGroup:s}},e.prototype.default=function(e,t){return void 0===t&&(t="table"),this._defaults[t]=e,this},e.prototype.table=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0].prop?{}:t.shift(),i=n.header,o=n.footer;return Object.assign(this._raw.table,{header:i,footer:o}),(e=this._raw.table.cols).push.apply(e,b(t)),this},e.prototype.header=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this._currentHeaderRow++,n=this.processRowOptions(e),i=this.genRowClass(n,r),o=e.map((function(e){var t={id:e.id,kind:"header",rowIndex:r};return Object.assign(t,e)}));return this._raw.header.push({rowIndex:r,rowClassName:i,cols:o,type:n&&n.type||"fixed"}),this},e.prototype.footer=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this._currentFooterRow++,n=this.processRowOptions(e),i=this.genRowClass(n,r),o=e.map((function(e){var t={id:e.id,kind:"footer",rowIndex:r};return Object.assign(t,e)}));return this._raw.footer.push({rowIndex:r,rowClassName:i,cols:o,type:n&&n.type||"fixed"}),this},e.prototype.headerGroup=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=this._currentHeaderRow++,n=this.processRowOptions(e,"prop"),i=this.genRowClass(n,r),o=e.map((function(e){return Object.assign({rowIndex:r},e)}));return this._raw.headerGroup.push({rowIndex:r,rowClassName:i,cols:o,type:n&&n.type||"fixed"}),this},e.prototype.processRowOptions=function(e,t){return void 0===t&&(t="id"),e[0][t]?void 0:e.shift()},e.prototype.genRowClass=function(e,t){return e&&e.rowClassName||"pbl-ngrid-row-index-"+t.toString()},e.prototype.buildHeaderGroups=function(e,t,r){for(var n,i=[],o=r.slice(),a=t.slice(),s=function(t,r){var s=o[t].orgProp,l=a.findIndex((function(e){return e.prop===s})),c=-1!==l?a.splice(l,1)[0]:a.find((function(e){return!e.prop}))||{prop:s,rowIndex:e,span:void 0},u=-1===l&&!!c.prop;c.prop=s,c.rowIndex=e;var d=c.span;if(!(d>=0)){d=0;for(var h=function(e){if(-1!==a.findIndex((function(t){return t.prop===o[e].orgProp})))return"break";d++},p=t+1;p<r;p++){if("break"===h(p))break}}c.span=d;var f=new ce(c,o.slice(t,t+d+1),u);i.push(f),n=t+=d},l=0,c=o.length;l<c;l++)s(l,c),l=n;return i},e}();var ge=function(){function e(){this._agg={pct:0,px:0,minRowWidth:0,pctCount:0,pxCount:0,count:0}}return Object.defineProperty(e.prototype,"minimumRowWidth",{get:function(){return this._agg.minRowWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultColumnWidth",{get:function(){var e=this._agg;return{pct:(100-e.pct)/e.count,px:e.px/e.count}},enumerable:!0,configurable:!0}),e.prototype.addColumn=function(e){var t=this._agg,r=e.parsedWidth,n=e.minWidth||0;if(r)switch(r.type){case"%":t.pctCount+=1,t.pct+=r.value;break;case"px":t.pxCount+=1,t.px+=r.value,n=r.value;break;default:throw new Error('Invalid width "'+e.width+'" in column '+e.prop+". Valid values are ##% or ##px (50% / 50px)")}else e.maxWidthLock?(t.pxCount+=1,t.px+=e.maxWidth):t.count+=1;t.minRowWidth+=n},e}();var ye=function(){function e(){this._groupBy=[],this.byId=new Map,this.resetIds(),this.resetColumns()}return Object.defineProperty(e.prototype,"primary",{get:function(){return this._primary},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidden",{set:function(e){this._hidden=e,this.setHidden()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupBy",{get:function(){return this._groupBy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupStore",{get:function(){return this._groupStore},enumerable:!0,configurable:!0}),e.prototype.addGroupBy=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.groupBy).push.apply(e,b(t)),this.setHidden()},e.prototype.removeGroupBy=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=function(e){var t=o.groupBy.findIndex((function(t){return t.id===e.id}));t>-1&&o.groupBy.splice(t,1)},o=this;try{for(var a=v(r),s=a.next();!s.done;s=a.next()){var l=s.value;i(l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}this.setHidden()},e.prototype.moveColumn=function(e,t){var r=this.columns,n=this.columnIds,i=this.allColumns,o=r.indexOf(t),a=r.indexOf(e);if(o>-1&&a>-1)return ve(n,a,o),ve(r,a,o),this._allHidden&&this._allHidden.length>0&&(o=i.indexOf(t),a=i.indexOf(e)),ve(i,a,o),!0},e.prototype.swapColumns=function(e,t){var r=this.columns.indexOf(e),n=this.columns.indexOf(t);if(r>-1&&n>-1){var i=this.columns,o=this.columnIds,a=this.allColumns;return i[r]=t,i[n]=e,o[r]=t.id,o[n]=e.id,this._allHidden&&this._allHidden.length>0&&(r=a.indexOf(e),n=a.indexOf(t)),a[r]=t,a[n]=e,!0}return!1},e.prototype.find=function(e){return this.byId.get(e)},e.prototype.getAllHeaderGroup=function(){return this._groupStore?this._groupStore.all:[]},e.prototype.getStaticWidth=function(){var e,t,r=new ge;try{for(var n=v(this.columns),i=n.next();!i.done;i=n.next()){var o=i.value;r.addColumn(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.invalidate=function(e){var t,n,i,o,a,s,l,c,u,d,h,p,f=this.lastSet="groupStore"in e?e:fe.fromDefinitionSet(e).build(),g=f.groupStore,y=f.table,m=f.header,b=f.footer,w=f.headerGroup;this._groupStore=g.clone();var C=new ge;this.resetColumns(),this.resetIds();var _=this._allHidden=(this._hidden||[]).concat(this._groupBy.map((function(e){return e.id})));this.headerColumnDef={rowClassName:y.header&&y.header.rowClassName||"",type:y.header&&y.header.type||"fixed"},this.footerColumnDef={rowClassName:y.footer&&y.footer.rowClassName||"",type:y.footer&&y.footer.type||"fixed"},this._primary=void 0;try{for(var x=v(y.cols),R=x.next();!R.done;R=x.next()){var S=R.value,k=void 0;k=new pe(S,this.groupStore),this.getColumnRecord(k.id).data=k,this.allColumns.push(k),k.hidden=_.indexOf(k.id)>-1,k.hidden||(this.columns.push(k),this.columnIds.push(k.id),C.addColumn(k)),k.pIndex&&(this._primary&&r.isDevMode()&&console.warn('Multiple primary index columns defined: previous: "'+this._primary.id+'", current: "'+k.id+'"'),this._primary=k)}}catch(e){t={error:e}}finally{try{R&&!R.done&&(n=x.return)&&n.call(x)}finally{if(t)throw t.error}}try{for(var D=v(m),O=D.next();!O.done;O=D.next()){var I=O.value,E=[];try{for(var A=(a=void 0,v(I.cols)),T=A.next();!T.done;T=A.next()){S=T.value,k=(N=this.getColumnRecord(S.id,this.metaColumns)).header||(N.header=new ne(S));E.push(k.id)}}catch(e){a={error:e}}finally{try{T&&!T.done&&(s=A.return)&&s.call(A)}finally{if(a)throw a.error}}this._metaRows.header[I.rowIndex]={rowDef:I,keys:E}}}catch(e){i={error:e}}finally{try{O&&!O.done&&(o=D.return)&&o.call(D)}finally{if(i)throw i.error}}try{for(var F=v(w),j=F.next();!j.done;j=F.next()){I=j.value;this._updateGroup(I)}}catch(e){l={error:e}}finally{try{j&&!j.done&&(c=F.return)&&c.call(F)}finally{if(l)throw l.error}}try{for(var W=v(b),M=W.next();!M.done;M=W.next()){I=M.value,E=[];try{for(var V=(h=void 0,v(I.cols)),H=V.next();!H.done;H=V.next()){var N;S=H.value,k=(N=this.getColumnRecord(S.id,this.metaColumns)).footer||(N.footer=new ne(S));E.push(k.id)}}catch(e){h={error:e}}finally{try{H&&!H.done&&(p=V.return)&&p.call(V)}finally{if(h)throw h.error}}this._metaRows.footer.push({rowDef:I,keys:E})}}catch(e){u={error:e}}finally{try{M&&!M.done&&(d=W.return)&&d.call(W)}finally{if(u)throw u.error}}P(C,this.columns,this.metaColumns)},e.prototype.updateGroups=function(){for(var e,t,r,n,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(0===i.length)try{for(var a=v(this.lastSet.headerGroup),s=a.next();!s.done;s=a.next()){var l=s.value;this._updateGroup(l)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}else{var c=i.slice();try{for(var u=v(this.lastSet.headerGroup),d=u.next();!d.done;d=u.next()){l=d.value;var h=c.indexOf(l.rowIndex);if(h>-1&&(c.splice(h,1),this._updateGroup(l),0===c.length))return}}catch(e){r={error:e}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}},e.prototype._updateGroup=function(e){for(var t,r,n=[],i=[],o=[],a=0;a<this.columns.length;a++){var s=[this.columns[a-1],this.columns[a],this.columns[a+1]],l=s.map((function(t){return t?t.getGroupOfRow(e.rowIndex):void 0})),c=-1!==o.lastIndexOf(l[1]),u=s[1],d=u.groupLogic(l,c);d!==l[1]&&(u.markNotInGroup(l[1]),u.markInGroup(d));var h=this.getColumnRecord(d.id,this.metaColumns);h.headerGroup||(h.headerGroup=d),-1===o.lastIndexOf(d)&&(i.push(d.id),d.isVisible&&n.push(d.id)),d.replace(u),o.push(d)}var p=function(t){if(t.rowIndex===e.rowIndex){var r=t.id,o=i.indexOf(r);-1!==o&&(i.splice(o,1),-1!==(o=n.indexOf(r))&&n.splice(o,1),f.metaColumns.splice(f.metaColumns.findIndex((function(e){return e.id===r})),1)),f._groupStore.remove(t)}},f=this;try{for(var g=v(this._groupStore.findGhosts()),y=g.next();!y.done;y=g.next()){p(y.value)}}catch(e){t={error:e}}finally{try{y&&!y.done&&(r=g.return)&&r.call(g)}finally{if(t)throw t.error}}this.updateMetaRow("header",e.rowIndex,{rowDef:e,keys:n,allKeys:i,isGroup:!0})},e.prototype.updateMetaRow=function(e,t,r){var n=this._metaRows[e][t]||{};this._metaRows[e][t]=Object.assign(n,r)},e.prototype.getColumnRecord=function(e,t){var r=this.byId.get(e);return r||(this.byId.set(e,r={id:e}),t&&t.push(r)),r},e.prototype.setHidden=function(){var e,t,r,n,i=this;this._allHidden=(this._hidden||[]).concat(this._groupBy.map((function(e){return e.id}))),this.columnIds=[],this.columns=[];try{for(var o=v(this.allColumns),a=o.next();!a.done;a=o.next()){var s=a.value;s.hidden=this._allHidden.indexOf(s.id)>-1,s.hidden||(this.columns.push(s),this.columnIds.push(s.id))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}try{for(var l=v(this._metaRows.header),c=l.next();!c.done;c=l.next()){var u=c.value;u.isGroup&&(u.keys=u.allKeys.filter((function(e){return i.find(e).headerGroup.isVisible})))}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}P(this.getStaticWidth(),this.columns,this.metaColumns)},e.prototype.resetColumns=function(){this.allColumns=[],this.columns=[],this.metaColumns=[],this.byId.clear()},e.prototype.resetIds=function(){this.columnIds=[],this._metaRows=this.metaColumnIds={header:[],footer:[]}},e}();function ve(e,t,r){var n=me(t,e.length-1),i=me(r,e.length-1);if(n!==i){for(var o=e[n],a=i<n?-1:1,s=n;s!==i;s+=a)e[s]=e[s+a];e[i]=o}}function me(e,t){return Math.max(0,Math.min(t,e))}var be=function(){function e(e){this.target=e}return Object.defineProperty(e.prototype,"column",{get:function(){return this._column},set:function(e){this.attachColumn(e)},enumerable:!0,configurable:!0}),e.prototype.attachColumn=function(e){this.detachColumn(),e&&(e.sizeInfo=this),this._column=e},e.prototype.detachColumn=function(){this._column&&(this._column.sizeInfo=void 0,this._column=void 0)},e.prototype.updateSize=function(){if(this.column&&!this.column.columnDef.isDragging){var e=this.target,t=e.getBoundingClientRect();this.width=t.width,this.height=t.height,this.style=getComputedStyle(e),this.column.columnDef.onResize()}},e}();var we=function(){function e(e){this._parent=e,this._multi={},this._multiDefaults={},this._singles={},this.changes$=new t.Subject,this.changes=this.changes$.asObservable(),this._parent?(this._parent.changes.pipe(I(this)).subscribe(this.changes$),this.root=this._parent.root):this.root=this}return Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),e.prototype.getRoot=function(){return this.root},e.prototype.getSingle=function(e){return this._singles[e]||this._parent&&this._parent.getSingle(e)},e.prototype.setSingle=function(e,t){t!==this.getSingle(e)&&(this._singles[e]=t,this.emitChanges({op:t?"add":"remove",type:e,value:t}))},e.prototype.getMultiDefault=function(e){return this._multiDefaults[e]||this._parent&&this._parent.getMultiDefault(e)},e.prototype.setMultiDefault=function(e,t){t!==this.getMultiDefault(e)&&(this._multiDefaults[e]=t,this.emitChanges({op:t?"add":"remove",type:e,value:t}))},e.prototype.getMulti=function(e){return this._multi[e]},e.prototype.addMulti=function(e,t){(this.getMulti(e)||(this._multi[e]=[])).push(t),"*"===t.name&&this.setMultiDefault(e,t),this.emitChanges({op:"add",type:e,value:t})},e.prototype.removeMulti=function(e,t){var r=this.getMulti(e);if(r){var n=r.indexOf(t);n>-1&&r.splice(n,1),this.emitChanges({op:"remove",type:e,value:t})}},e.prototype.forMulti=function(e,t){for(var r=this,n=0;r;){var i=r.getMulti(e);if(i&&(n++,!0===t(i)))return;r=r.parent}return n},e.prototype.ngOnDestroy=function(){this.changes$.complete(),I.kill(this)},e.prototype.bufferStart=function(){this.root.bufferedData||(this.root.bufferedData=[])},e.prototype.bufferEnd=function(){if(this.root.bufferedData){var e=this.root.bufferedData;this.root.bufferedData=void 0,this.emitChanges(e)}},e.prototype.emitChanges=function(e){var t,r=Array.isArray(e)?e:[e];this.root.bufferedData?(t=this.root.bufferedData).push.apply(t,b(r)):this.changes$.next(r)},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:e,decorators:[{type:r.Optional},{type:r.SkipSelf}]}]},e.ɵprov=r.ɵɵdefineInjectable({factory:function(){return new e(r.ɵɵinject(e,12))},token:e,providedIn:"root"}),e}();var Ce=function(){function e(e,t){this.tRef=e,this.registry=t}return e.prototype.ngOnInit=function(){this instanceof _e?this.registry.addMulti("headerCell",this):this instanceof xe?this.registry.addMulti("tableCell",this):this instanceof Re?this.registry.addMulti("editorCell",this):this instanceof Se&&this.registry.addMulti("footerCell",this)},e.prototype.ngOnDestroy=function(){this instanceof _e?this.registry.removeMulti("headerCell",this):this instanceof xe?this.registry.removeMulti("tableCell",this):this instanceof Re?this.registry.removeMulti("editorCell",this):this instanceof Se&&this.registry.removeMulti("footerCell",this)},e}();var _e=function(e){function t(t,r){return e.call(this,t,r)||this}return g(t,e),t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridHeaderCellDef], [pblNgridHeaderCellTypeDef]",inputs:["name:pblNgridHeaderCellDef","type:pblNgridHeaderCellTypeDef"]}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:we}]},t}(Ce),xe=function(e){function t(t,r){return e.call(this,t,r)||this}return g(t,e),t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridCellDef], [pblNgridCellTypeDef]",inputs:["name:pblNgridCellDef","type:pblNgridCellTypeDef"]}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:we}]},t}(Ce);var Re=function(e){function t(t,r){return e.call(this,t,r)||this}return g(t,e),t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridCellEditorDef], [pblNgridCellEditorTypeDef]",inputs:["name:pblNgridCellEditorDef","type:pblNgridCellEditorTypeDef"]}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:we}]},t}(Ce);var Se=function(e){function t(t,r){return e.call(this,t,r)||this}return g(t,e),t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridFooterCellDef], [pblNgridFooterCellTypeDef]",inputs:["name:pblNgridFooterCellDef","type:pblNgridFooterCellTypeDef"]}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:we}]},t}(Ce);function ke(e,t,r,n){var i=e.getMulti(r);if(i){var o=void 0;if(he(t))switch(r){case"headerCell":t.headerType&&(o={id:t.id,type:t.headerType});break;case"footerCell":t.footerType&&(o={id:t.id,type:t.footerType})}o||(o=t);var a=function(e,t,r){var n,i;try{for(var o=v(e),a=o.next();!a.done;a=o.next()){var s=a.value;if(s.type){if(t.type&&s.type===t.type.name)return s}else if(s.name===t.id)return s}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}(i,o);if(a)return a}if(n&&e.parent)return ke(e.parent,t,r,n)}var De=function(){function e(){}return Object.defineProperty(e.prototype,"$implicit",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this.grid},enumerable:!0,configurable:!0}),e.create=function(t,r){var n=new e;return n.col=t,n.grid=r,n},e}();var Oe=function(){function e(){this._editing=!1,this._focused=!1,this._selected=!1}return Object.defineProperty(e.prototype,"$implicit",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"row",{get:function(){return this.rowContext.$implicit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.col.getValue(this.row)},set:function(e){this.col.setValue(this.row,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowContext",{get:function(){return this._rowContext},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editing",{get:function(){return this._editing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focused",{get:function(){return this._focused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"table",{get:function(){return this.grid},enumerable:!0,configurable:!0}),e.create=function(t,r,n){var i=new e;return i._rowContext=t,i.col=r,i.extApi=n,Object.defineProperties(i,{grid:{value:n.grid},index:{value:n.grid.columnApi.indexOf(r)}}),i},e.defaultState=function(){return{editing:!1,focused:!1,selected:!1}},e.prototype.clone=function(){var t=e.create(this._rowContext,this.col,this.extApi);return t.fromState(this.getState(),this._rowContext,!0),t},e.prototype.getState=function(){return{editing:this._editing,focused:this._focused,selected:this._selected}},e.prototype.fromState=function(e,t,r){var n=!r&&this._editing===e.editing;this._rowContext=t,this._editing=e.editing,this._focused=e.focused,this._selected=e.selected,n&&t.updateCell(this)},e.prototype.startEdit=function(e){this.col.editorTpl&&!this.editing&&(this._editing=!0,this._rowContext.updateCell(this),e&&this.grid._cdkTable.syncRows("data",!0,this.rowContext.index))},e.prototype.stopEdit=function(e){this.editing&&!this.grid.viewport.isScrolling&&(this._editing=!1,this._rowContext.updateCell(this),e&&this.grid._cdkTable.syncRows("data",this.rowContext.index))},e}();var Pe=function(){function e(e,t,r){this.identity=e,this.dataIndex=t,this.extApi=r,r.cdkTable.multiTemplateDataRows&&Object.defineProperty(this,"index",{get:function(){return this.renderIndex}}),this.grid=this.table=r.grid;for(var n=this.cells=[],i=r.grid.columnApi.columns,o=i.length,a=0;a<o;a++){var s=Oe.create(this,i[a],r);n.push(s)}}return Object.defineProperty(e.prototype,"length",{get:function(){return this.cells&&this.cells.length||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pblRowContext",{get:function(){return this},set:function(e){},enumerable:!0,configurable:!0}),e.defaultState=function(e,t,r){for(var n=[],i=0;i<r;i++)n.push(Oe.defaultState());return{identity:e,dataIndex:t,cells:n,firstRender:!0}},e.prototype.getState=function(){return{identity:this.identity,dataIndex:this.dataIndex,firstRender:this.firstRender,cells:this.cells.map((function(e){return e.getState()}))}},e.prototype.fromState=function(e){this.identity=e.identity,this.firstRender=e.firstRender,this.dataIndex=e.dataIndex;for(var t=0,r=this.cells.length;t<r;t++)this.cells[t].fromState(e.cells[t],this)},e.prototype.updateContext=function(e){e.dataIndex=this.dataIndex,Object.assign(this,e)},e.prototype.cell=function(e){var t="number"==typeof e?e:this.grid.columnApi.indexOf(e);return this.cells[t]},e.prototype.getCells=function(){return this.cells&&this.cells.slice()||[]},e.prototype.updateCell=function(e){this.cells[e.index]=e.clone()},e.prototype.updateOutOfViewState=function(){this.extApi.contextApi.updateOutOfViewState(this)},e}();function Ie(e,t){return e.matches?e.matches(t):e.msMatchesSelector(t)}function Ee(e,t){if(!(e instanceof Node))return null;for(var r=e;null!=r&&!(r instanceof Element&&Ie(r,t));)r=r.parentNode;return r||null}function Ae(e){return Array.from(Ee(e,"pbl-cdk-table").querySelectorAll("pbl-ngrid-row")).indexOf(e)}function Te(e,t){var r,n,i,o,a,s;if("rowIdent"in(s=e)&&"colIndex"in s)r=e.rowIdent,n=e.colIndex;else{if(!function(e){return"rowContext"in e&&"index"in e}(e)){var l=m((o=Ee(i=e,"pbl-ngrid-row"),a=Array.from(o.querySelectorAll("pbl-ngrid-cell")),[Ae(o),a.indexOf(i)]),2),c=l[0],u=l[1];if(f=t.viewCache.get(c)){var d=t.columnApi.findColumnAt(u),h=t.columnApi.indexOf(d);return f.cell(h)}return}r=e.rowContext.identity,n=e.index}var p=t.cache.get(r);if(p){var f;if(f=t.extApi.grid.contextApi.findRowInView(p.identity))return f.cell(n);if(p.cells[n])return[p,n]}}var Fe=function(){function e(e){var r=this;this.extApi=e,this.viewCache=new Map,this.cache=new Map,this.activeSelected=[],this.focusChanged$=new t.BehaviorSubject({prev:void 0,curr:void 0}),this.selectionChanged$=new t.Subject,this.focusChanged=this.focusChanged$.pipe(o.buffer(this.focusChanged$.pipe(o.debounceTime(0,t.asapScheduler))),o.map((function(e){return{prev:e[0].prev,curr:e[e.length-1].curr}}))),this.selectionChanged=this.selectionChanged$.asObservable(),this.vcRef=e.cdkTable._rowOutlet.viewContainer,this.columnApi=e.grid.columnApi,e.events.pipe(o.filter((function(e){return"onDestroy"===e.kind}))).subscribe((function(e){return r.destroy()}));var n=function(){for(var e,t,n=r.getViewRect(),i=new Set(Array.from(r.viewCache.values()).map((function(e){return e.identity}))),o=new Map,a=!!n,s=0,l=r.vcRef.length;s<l;s++){var c=r.findViewRef(s),u=r.findRowContext(c,s);if(r.viewCache.set(s,u),i.delete(u.identity),c.context.$implicit!==u.$implicit)(y=o.get(u.$implicit)||[-1,-1])[1]=s,o.set(u.$implicit,y),(y=o.get(c.context.$implicit)||[-1,-1])[0]=s,o.set(c.context.$implicit,y);a&&(a=je(c,n,"top"))}if(o.size>0){var d=Array.from(o.entries()).filter((function(e){var t=e[1];return-1!==t[0]&&(-1!==t[1]||(r.viewCache.get(t[0]).$implicit=e[0],!1))})).map((function(e){return e[1]}));if(o.clear(),d.length){var h=d[d.length-1][0]-d[d.length-1][1]>0?function(e,t){return t[1]-e[1]}:function(e,t){return e[1]-t[1]};d.sort(h);var p={data:r.viewCache.get(d[0][0]).$implicit,state:r.viewCache.get(d[0][0]).getState(),pair:d.pop()};try{for(var f=v(d),g=f.next();!g.done;g=f.next()){var y=g.value,m=r.viewCache.get(y[0]),b=r.viewCache.get(y[1]),w=b.getState();w.identity=m.identity,r.cache.set(m.identity,w),m.fromState(w),m.$implicit=b.$implicit}}catch(t){e={error:t}}finally{try{g&&!g.done&&(t=f.return)&&t.call(f)}finally{if(e)throw e.error}}var C=r.viewCache.get(p.pair[0]);p.state.identity=C.identity,r.cache.set(C.identity,p.state),C.fromState(p.state),C.$implicit=p.data}}if(n)for(s=r.vcRef.length-1;s>-1&&je(r.findViewRef(s),n,"bottom");s--);i.forEach((function(e){return r.cache.get(e).firstRender=!1}))};n(),e.cdkTable.onRenderRows.subscribe(n)}return Object.defineProperty(e.prototype,"focusedCell",{get:function(){return this.activeFocused?y({},this.activeFocused):void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedCells",{get:function(){return this.activeSelected.slice()},enumerable:!0,configurable:!0}),e.prototype.focusCell=function(e,t){if(e&&!0!==e){var r=Te(e,this);r&&(this.focusCell(t),r instanceof Oe?r.focused||this.extApi.grid.viewport.isScrolling||(this.updateState(r.rowContext.identity,r.index,{focused:!0}),this.activeFocused={rowIdent:r.rowContext.identity,colIndex:r.index},this.selectCells([this.activeFocused],t,!0),t&&this.extApi.grid._cdkTable.syncRows("data",r.rowContext.index)):(this.updateState(r[0].identity,r[1],{focused:!0}),this.activeFocused={rowIdent:r[0].identity,colIndex:r[1]}),this.emitFocusChanged(this.activeFocused))}else if(this.activeFocused){var n=this.activeFocused,i=n.rowIdent,o=n.colIndex;if(this.activeFocused=void 0,this.updateState(i,o,{focused:!1}),this.emitFocusChanged(this.activeFocused),t){var a=this.findRowInView(i);a&&this.extApi.grid._cdkTable.syncRows("data",a.index)}}},e.prototype.selectCells=function(e,t,r){var n,i,o,a=new Set;r&&this.unselectCells();var s=[];try{for(var l=v(e),c=l.next();!c.done;c=l.next()){var u=Te(c.value,this);if(u instanceof Oe){if(!u.selected&&!this.extApi.grid.viewport.isScrolling){var d=u.rowContext.identity,h=u.index;this.updateState(d,h,{selected:!0});var p={rowIdent:d,colIndex:h};this.activeSelected.push(p),s.push(p),t&&a.add(u.rowContext.index)}}else if(u){var f=m(u,2),g=f[0];h=f[1];g.cells[h].selected||(this.updateState(g.identity,h,{selected:!0}),this.activeSelected.push({rowIdent:g.identity,colIndex:h}))}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}a.size>0&&(o=this.extApi.grid._cdkTable).syncRows.apply(o,b(["data"],Array.from(a.values()))),this.selectionChanged$.next({added:s,removed:[]})},e.prototype.unselectCells=function(e,t){var r,n,i,o=new Set,a=this.activeSelected,s=!0;Array.isArray(e)?(a=e,s=!1):(t=!!e,this.activeSelected=[]);var l=[],c=function(e){var r=Te(e,u);if(r instanceof Oe){if(r.selected){var n=r.rowContext.identity,i=r.index;if(u.updateState(n,i,{selected:!1}),!s)E(u.activeSelected,(function(e){return e.colIndex===i&&e.rowIdent===n}))&&l.push({rowIdent:n,colIndex:i});t&&o.add(r.rowContext.index)}}else if(r){var a=m(r,2),c=a[0],d=a[1];if(c.cells[d].selected)if(u.updateState(c.identity,d,{selected:!1}),!s)E(u.activeSelected,(function(e){return e.colIndex===d&&e.rowIdent===c.identity}))&&l.push({rowIdent:c.identity,colIndex:d})}},u=this;try{for(var d=v(a),h=d.next();!h.done;h=d.next()){c(h.value)}}catch(e){r={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}o.size>0&&(i=this.extApi.grid._cdkTable).syncRows.apply(i,b(["data"],Array.from(o.values()))),this.selectionChanged$.next({added:[],removed:l})},e.prototype.clear=function(){for(var e=0,t=this.vcRef.length;e<t;e++){this.findViewRef(e).context.pblRowContext=void 0}this.viewCache.clear(),this.cache.clear()},e.prototype.getRow=function(e){var t="number"==typeof e?e:Ae(e);return this.rowContext(t)},e.prototype.getCell=function(e,t){if("number"==typeof e){var r=this.rowContext(e);if(r)return r.cell(t)}else{var n=Te(e,this);if(n instanceof Oe)return n}},e.prototype.getDataItem=function(e){var t=Te(e,this);if(t instanceof Oe)return t.col.getValue(t.rowContext.$implicit);if(t){var r=this.extApi.grid.ds.source[t[0].dataIndex];return this.extApi.grid.columnApi.findColumnAt(t[1]).getValue(r)}},e.prototype.createCellContext=function(e,t){var r=this.rowContext(e),n=this.columnApi.indexOf(t);return r.cell(n)},e.prototype.rowContext=function(e){return this.viewCache.get(e)},e.prototype.updateOutOfViewState=function(e){var t=this.getViewRect();je(this.findViewRef(e.index),t)},e.prototype.updateState=function(e,t,r){var n=this.cache.get(e);if(n){if("number"==typeof t){var i=n.cells[t];i&&Object.assign(i,r)}else Object.assign(n,t);var o=this.findRowInView(e);o&&o.fromState(n)}},e.prototype.findRowInView=function(e){var t=this.cache.get(e);if(t){var r=t.dataIndex-this.extApi.grid.ds.renderStart,n=this.viewCache.get(r);if(n&&n.identity===e)return n}},e.prototype.findRowInCache=function(e,t,r){var n=this.cache.get(e);if(!t)return n;var i=n.dataIndex+t,o=this.getRowIdentity(i);if(null!==o){var a=this.findRowInCache(o);return!a&&r&&i<this.extApi.grid.ds.length&&(a=Pe.defaultState(o,i,this.columnApi.columns.length),this.cache.set(o,a)),a}},e.prototype.getRowIdentity=function(e,t){var r=this.extApi.grid.ds,n=this.extApi.columnStore.primary,i=t?t.$implicit:r.source[e];return i?n?n.getValue(i):e:null},e.prototype.findViewRef=function(e){return this.vcRef.get(e)},e.prototype.findRowContext=function(e,t){var r=this,n=e.context,i=this.extApi.grid.ds.renderStart+t,o=this.getRowIdentity(i,e.context),a=n.pblRowContext;if(this.cache.has(o)||this.cache.set(o,Pe.defaultState(o,i,this.columnApi.columns.length)),a){if(a.identity===o)return a;this.cache.set(a.identity,a.getState()),a.updateContext(n);var s=i-a.dataIndex;if(s>0){var l=this.findViewRef(t+s),c=l&&l.context.pblRowContext;c&&this.cache.set(c.identity,c.getState())}}else(a=n.pblRowContext=new Pe(o,i,this.extApi)).updateContext(n),e.onDestroy((function(){r.viewCache.delete(t),n.pblRowContext=void 0}));return a.fromState(this.cache.get(o)),a},e.prototype.getViewRect=function(){return this.extApi.grid.viewport.elementRef.nativeElement.getBoundingClientRect()},e.prototype.emitFocusChanged=function(e){this.focusChanged$.next({prev:this.focusChanged$.value.curr,curr:e})},e.prototype.destroy=function(){this.focusChanged$.complete(),this.selectionChanged$.complete()},e}();function je(e,t,r){var n,i=e.rootNodes[0],o=e.context.pblRowContext,a=i.getBoundingClientRect();switch(r){case"top":n=a.bottom>=t.top;break;case"bottom":n=a.top<=t.bottom;break;default:n=a.bottom>=t.top&&a.top<=t.bottom}if(n){if(!o.outOfView)return!1;o.outOfView=!1}else o.outOfView=!0;return!0}var We=function(){function e(e){this.strategy=e,this.cols=new Map,this._minimumRowWidth=0}return Object.defineProperty(e.prototype,"minimumRowWidth",{get:function(){return this._minimumRowWidth},enumerable:!0,configurable:!0}),e.prototype.widthBreakout=function(e){return Me(this.strategy,e)},e.prototype.addColumn=function(e){if(!this.cols.has(e)){var t=e.column,r=t.minWidth||0;t.isFixedWidth&&(r=Math.max(t.parsedWidth.value,r));var n=this.strategy.cell(e),i=r+n;if(this.cols.set(e,i),this._minimumRowWidth+=i,t.maxWidth){var o=e.width-n;t.checkMaxWidthLock(o)&&(this.maxWidthLockChanged=!0)}}},e.prototype.addGroup=function(e){var t,r,n=0;try{for(var i=v(e),o=i.next();!o.done;o=i.next()){var a=o.value;this.addColumn(a),n+=a.width}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n-=this.strategy.group(e)},e}();function Me(e,t){var r=e.cell(t);return{content:t.width-r,nonContent:r}}var Ve={cell:function(e){var t=e.style;return parseInt(t.paddingLeft)+parseInt(t.paddingRight)},groupCell:function(e){return 0},group:function(e){var t=e.length;return t>0?parseInt(e[0].style.paddingLeft)+parseInt(e[t-1].style.paddingRight):0}};var He=function(){function e(){}return e.create=function(t,r,n){var i=new e;return i.grid=t,i.store=r,i.extApi=n,i},Object.defineProperty(e.prototype,"groupByColumns",{get:function(){return this.store.groupBy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleColumnIds",{get:function(){return this.store.columnIds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleColumns",{get:function(){return this.store.columns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.store.allColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalColumnWidthChange",{get:function(){var e=this;return this._totalColumnWidthChange||(this._totalColumnWidthChange=this.extApi.events.pipe(o.filter((function(e){return"onResizeRow"===e.kind})),o.map((function(t){return e.grid.columnApi.visibleColumns.reduce((function(e,t){return e+t.sizeInfo.width}),0)})))),this._totalColumnWidthChange},enumerable:!0,configurable:!0}),e.prototype.findColumnAt=function(e){return this.store.columns[e]},e.prototype.findColumn=function(e){var t=this.store.find(e);if(t)return t.data},e.prototype.renderIndexOf=function(e){var t="string"==typeof e?this.findColumn(e):e;return this.store.columns.indexOf(t)},e.prototype.indexOf=function(e){var t="string"==typeof e?this.findColumn(e):e;return this.store.allColumns.indexOf(t)},e.prototype.resizeColumn=function(e,t){e.updateWidth(t)},e.prototype.autoSizeColumn=function(e){var t=this.findColumnAutoSize(e);this.resizeColumn(e,t+"px")},e.prototype.autoSizeColumns=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=r.length>0?r:this.visibleColumns;try{for(var o=v(i),a=o.next();!a.done;a=o.next()){var s=a.value,l=this.findColumnAutoSize(s);s.updateWidth(l+"px")}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.autoSizeToFit=function(e,t){var r,n;void 0===t&&(t={});var i=this.extApi.dynamicColumnWidthFactory(),o=this.visibleColumns,a=t.columnBehavior||function(){return t},s=0,l=0,c=[],u=o.map((function(r,n){var o=i.widthBreakout(r.sizeInfo),u=y(y({},a(r)||{}),t);return s+=o.content,e-=o.nonContent,u.keepMinWidth&&r.minWidth&&(l+=r.minWidth,c.push(n)),y(y({},o),{instructions:u})})),d=l/e,h=(s*d-l)/(1-d);try{for(var p=v(c),f=p.next();!f.done;f=p.next()){var g=h*(o[m=f.value].minWidth/l);u[m].content+=g,s+=g}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}for(var m=0;m<o.length;m++){var b=u[m],w=b.instructions,C=o[m],_=b.content/s;w.keepMinWidth&&C.minWidth||(C.minWidth=void 0),w.keepMaxWidth&&C.maxWidth||(C.maxWidth=void 0,C.checkMaxWidthLock(C.sizeInfo.width));var x=void 0,R=w.forceWidthType;"px"===R||!R&&C.isFixedWidth?x=e*_+"px":("%"===R||!R&&C.width)&&(x=100*_+"%"),x&&C.updateWidth(x)}this.grid.resetColumnsWidth(),this.grid.resizeColumns()},e.prototype.moveColumn=function(e,t,r){if(he(t)){var n=e!==t&&this.store.moveColumn(e,t);return n&&!0!==r&&this.afterColumnPositionChange(),n}var i=this.findColumnAt(t);return!!i&&this.moveColumn(e,i)},e.prototype.swapColumns=function(e,t,r){var n=this.store.swapColumns(e,t);return n&&!0!==r&&this.afterColumnPositionChange(),n},e.prototype.addGroupBy=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.store).addGroupBy.apply(e,b(t))},e.prototype.removeGroupBy=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=this.store).removeGroupBy.apply(e,b(t))},e.prototype.findColumnAutoSize=function(e){var t,r,n=e.columnDef.queryCellElements(),i=0;try{for(var o=v(n),a=o.next();!a.done;a=o.next()){var s=a.value,l=s.firstElementChild||s;l.scrollWidth>i&&(i=l.scrollWidth+1)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return i},e.prototype.afterColumnPositionChange=function(){this.extApi.contextApi.clear(),this.store.updateGroups(),this.grid.resetColumnsWidth(),this.grid.resizeColumns()},e}();var Ne=function(){function e(e){var r=this;this.extApi=e,this.header={fixed:[],row:[],sticky:[],all:[]},this.footer={fixed:[],row:[],sticky:[],all:[]},this.sync$=new t.Subject,this.hzScroll$=new t.Subject,this.sync=this.sync$.pipe(o.debounceTime(0,t.asapScheduler)),this.hzScroll=this.hzScroll$.asObservable(),e.onInit((function(){var n=e.grid,i=n.viewport.measureScrollOffset("start"),a=!0;n.viewport.elementScrolled().pipe(o.filter((function(){return a})),o.auditTime(0,t.animationFrameScheduler)).subscribe((function(){var e=n.viewport.measureScrollOffset("start");i!==e?r.hzScroll$.next(i=e):n.viewport.isScrolling&&(a=!1,n.viewport.scrolling.pipe(o.take(1)).subscribe((function(){return a=!0})))}),null,(function(){return r.hzScroll$.complete()}))}))}return e.prototype.addMetaRow=function(e){var t=this.extApi.columnStore,r=t.metaColumnIds,n=r.header,i=r.footer,o=e.meta;if(o===t.headerColumnDef)!0===e.gridWidthRow?(this.gridWidthRow={rowDef:o,el:e.elRef.nativeElement},this.header.all.push(o)):this.addToSection(this.header,e,t.metaColumnIds.header.length);else if(o===t.footerColumnDef)this.addToSection(this.footer,e,0);else{var a=n.findIndex((function(e){return e.rowDef===o}));if(a>-1)this.addToSection(this.header,e,a);else{if(!((a=i.findIndex((function(e){return e.rowDef===o})))>-1))throw new Error("Invalid operation");this.addToSection(this.footer,e,a)}}this.sync$.next()},e.prototype.removeMetaRow=function(e){var t=e.meta,r=this.header.all.indexOf(e.meta);r>-1?(this.header.all.splice(r,1),r=this.header[t.type].findIndex((function(e){return e.rowDef===t})),this.header[t.type].splice(r,1)):(r=this.footer.all.indexOf(e.meta))>-1&&(this.footer.all.splice(r,1),r=this.footer[t.type].findIndex((function(e){return e.rowDef===t})),this.footer[t.type].splice(r,1))},e.prototype.addToSection=function(e,t,r){var n=t.meta;e[n.type].push({index:r,rowDef:n,el:t.elRef.nativeElement}),e.all.push(n)},e.decorators=[{type:r.Injectable}],e.ctorParameters=function(){return[{type:void 0,decorators:[{type:r.Inject,args:[D]}]}]},e}();var ze=function(){function e(e,r){var n=this;this.metaRows=e,this._width$=new t.Subject,this._totalColumnWidth=0,this.element=r.nativeElement,e.sync.pipe(I(this)).subscribe((function(){return n.syncRowDefinitions()})),this.metaRows.extApi.events.pipe(I(this)).subscribe((function(e){"onResizeRow"===e.kind&&n.updateWidths()})),this.metaRows.extApi.grid.columnApi.totalColumnWidthChange.pipe(I(this)).subscribe((function(e){n._totalColumnWidth=e,n.updateWidths()}))}return e.prototype.ngOnChanges=function(e){var t=this;if("type"in e){var r=this.element;r.scrollLeft=this.metaRows.extApi.grid.viewport.measureScrollOffset("start"),e.type.isFirstChange&&(this.metaRows.hzScroll.pipe(I(this)).subscribe((function(e){return r.scrollLeft=e})),this.metaRows.extApi.cdkTable.onRenderRows.pipe(I(this)).subscribe((function(){t.updateWidths()})))}},e.prototype.ngOnDestroy=function(){this._width$.complete(),I.kill(this)},e.prototype.updateWidths=function(){this._innerWidth=this.metaRows.extApi.grid.viewport.innerWidth,this._minWidth=this.metaRows.extApi.cdkTable.minWidth,this._width=Math.max(this._innerWidth,this._minWidth),this._width$.next(Math.max(this._innerWidth,this._totalColumnWidth))},e.prototype.syncRowDefinitions=function(){var e,t,r="header"===this.type,n=r?this.metaRows.header:this.metaRows.footer,i=this.element.firstElementChild,o=i.nextElementSibling;r&&i.appendChild(this.metaRows.gridWidthRow.el);try{for(var a=v(n.fixed),s=a.next();!s.done;s=a.next()){var l=s.value;o.appendChild(l.el)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}},e.decorators=[{type:r.Component,args:[{selector:"div[pbl-ngrid-fixed-meta-row-container]",template:'<div class="pbl-cdk-table" [style.width.px]="_width"></div><div class="pbl-cdk-table" [style.width.px]="_width$ | async"></div>',host:{style:"flex: 0 0 auto; overflow: hidden;","[style.width.px]":"_innerWidth"}}]}],e.ctorParameters=function(){return[{type:Ne},{type:r.ElementRef}]},e.propDecorators={type:[{type:r.Input,args:["pbl-ngrid-fixed-meta-row-container"]}]},e}();var Le=function(){function e(e,t,r){this.metaRows=e,this.elRef=t,this.gridWidthRow=null!==r}return Object.defineProperty(e.prototype,"meta",{get:function(){return this._meta},set:function(e){e!==this._meta&&this.update(e)},enumerable:!0,configurable:!0}),e.prototype.ngOnDestroy=function(){this.metaRows.removeMetaRow(this)},e.prototype.update=function(e){var t=this._meta;t&&(t.rowClassName&&this.elRef.nativeElement.classList.remove(t.rowClassName),this.metaRows.removeMetaRow(this)),this._meta=e,e&&(e.rowClassName&&this.elRef.nativeElement.classList.add(e.rowClassName),this.metaRows.addMetaRow(this))},e.decorators=[{type:r.Directive,args:[{selector:"[pblMetaRow]"}]}],e.ctorParameters=function(){return[{type:Ne},{type:r.ElementRef},{type:void 0,decorators:[{type:r.Attribute,args:["gridWidthRow"]}]}]},e.propDecorators={meta:[{type:r.Input,args:["pblMetaRow"]}]},e}();function $e(e,t){if(e.allColumns.length>0&&t){var n=1;if(!e.primary){n=2;var i=e.find(t);i&&i.data&&(n=3,e._primary=i.data)}if(r.isDevMode()){var o='The [identityProp] input is deprecated, please remove it and use "pIndex" on the column definition instead.';switch(n){case 1:console.warn(o+'\nFound column "'+e.primary.id+'" defined with the new method (pIndex), ignoring "'+t+'" set in [identityProp]');break;case 2:console.warn(o+'\nCould not find a column defined with the new method (pIndex).\nTrying to locate the column "'+t+'" defined in [identityProp] FAILED! with no match.\nAN IDENTITY COLUMN WAS NOT SET');break;case 3:console.warn(o+'\nCould not find a column defined with the new method (pIndex).\nTrying to locate the column "'+t+'" defined in [identityProp] SUCCEEDED!.\nUSING "'+t+'" AS THE IDENTITY COLUMN.')}}}}function Be(e){return e._extApi}function Ge(e){return e._plugin.controller}function qe(e){return e._extApi.metaRowService}var Ue=function(){function e(e,t,r,n,i,o,a,s,l){this.elRef=r,this.differs=n,this.ngZone=i,this.cdr=o,this.config=a,this.registry=s,this.id=l,this.rowClassUpdateFreq="item",this.rowFocus="",this.cellFocus="",this._fallbackMinHeight=0,this._store=new ye,this._noCachePaginator=!1;var c=a.get("table");this.showHeader=c.showHeader,this.showFooter=c.showFooter,this.noFiller=c.noFiller,this.initExtApi(),this.columnApi=He.create(this,this._store,this._extApi),this.initPlugins(e,r,t)}return Object.defineProperty(e.prototype,"showHeader",{get:function(){return this._showHeader},set:function(e){this._showHeader=a.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showFooter",{get:function(){return this._showFooter},set:function(e){this._showFooter=a.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noFiller",{get:function(){return this._noFiller},set:function(e){this._noFiller=a.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"identityProp",{get:function(){return this.__identityProp},set:function(e){this.__identityProp=e,$e(this._store,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataSource",{set:function(e){e instanceof Z?this.setDataSource(e):this.setDataSource(K().onTrigger((function(){return e||[]})).create())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ds",{get:function(){return this._dataSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"usePagination",{get:function(){return this._pagination},set:function(e){""===e&&(e="pageNumber"),e!==this._pagination&&(this._pagination=e,this.setupPaginator())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noCachePaginator",{get:function(){return this._noCachePaginator},set:function(e){e=a.coerceBooleanProperty(e),this._noCachePaginator!==e&&(this._noCachePaginator=e,this.ds&&this.ds.paginator&&(this.ds.paginator.noCacheMode=e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideColumns",{set:function(e){this._hideColumns=e,this._hideColumnsDirty=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fallbackMinHeight",{get:function(){return this._fallbackMinHeight},set:function(e){e=a.coerceNumberProperty(e),this._fallbackMinHeight!==e&&(this._fallbackMinHeight=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metaColumnIds",{get:function(){return this._store.metaColumnIds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"metaColumns",{get:function(){return this._store.metaColumns},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnRowDef",{get:function(){return{header:this._store.headerColumnDef,footer:this._store.footerColumnDef}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextApi",{get:function(){return this._extApi.contextApi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewport",{get:function(){return this._viewport},enumerable:!0,configurable:!0}),e.prototype.ngDoCheck=function(){if(this._hideColumnsDirty){this._hideColumnsDirty=!1;var e=this._hideColumns;if(!this._colHideDiffer&&e)try{this._colHideDiffer=this.differs.find(e).create()}catch(t){throw new Error("Cannot find a differ supporting object '"+e+". hideColumns only supports binding to Iterables such as Arrays.")}}if(this._colHideDiffer){var t=this._hideColumns||[];this._colHideDiffer.diff(t)&&(this._store.hidden=t,this._minimumRowWidth="",this.attachCustomCellTemplates(),this.attachCustomHeaderCellTemplates(),this._cdkTable.syncRows("header")),this._hideColumns||(this._colHideDiffer=void 0)}},e.prototype.ngAfterContentInit=function(){var e=this;this.registry.changes.subscribe((function(t){var r,n,i=!1,o=!1;try{for(var a=v(t),s=a.next();!s.done;s=a.next()){switch(s.value.type){case"tableCell":i=!0;break;case"headerCell":case"footerCell":o=!0;break;case"noData":e.setupNoData();break;case"paginator":e.setupPaginator()}}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}i&&e.attachCustomCellTemplates(),o&&e.attachCustomHeaderCellTemplates()}))},e.prototype.ngAfterViewInit=function(){var e=this;this.invalidateColumns(),Object.defineProperty(this,"isInit",{value:!0}),this._plugin.emitEvent({kind:"onInit"}),this.setupPaginator();var t=document.createElement("div");t.classList.add("pbl-ngrid-empty-spacer"),this._cdkTable._element.insertBefore(t,this._cdkTable._footerRowOutlet.elementRef.nativeElement),this.listenToResize(),this.contextApi.focusChanged.subscribe((function(t){if(t.curr){var r=e.contextApi.findRowInView(t.curr.rowIdent);if(r){var n=e._cdkTable._rowOutlet.viewContainer.get(r.index);if(n){var i=e.columnApi.renderIndexOf(e.columnApi.columns[t.curr.colIndex]),o=n.rootNodes[0].querySelectorAll("pbl-ngrid-cell")[i];o&&o.focus()}}}}))},e.prototype.ngOnChanges=function(e){var t=!1;e.focusMode&&(this.rowFocus="row"===this.focusMode?0:"",this.cellFocus="cell"===this.focusMode?0:""),e.columns&&this.isInit&&(t=!0),!0===t&&this.invalidateColumns()},e.prototype.ngOnDestroy=function(){var e,t=this,r=function(){t._plugin.destroy(),t._viewport&&t._cdkTable.detachViewPort(),I.kill(t)};this._plugin.emitEvent({kind:"onDestroy",wait:function(t){return e=t}}),e?e.then(r).catch(r):r()},e.prototype.trackBy=function(e,t){return e},e.prototype.setSort=function(e,t,n){if(void 0===n&&(n=!1),e&&"boolean"!=typeof e){var i;if("string"==typeof e){if(!(i=this._store.columns.find((function(t){return t.alias?t.alias===e:t.sort&&t.id===e})))&&r.isDevMode())return void console.warn('Could not find column with alias "'+e+'".')}else i=e;this.ds.setSort(i,t,n)}else this.ds.setSort(!!e)},e.prototype.setFilter=function(e,t){var n,i;if(arguments.length>0){var o=void 0;if(Array.isArray(t)&&"string"==typeof t[0]){o=[];var a=function(e){var t=s._store.columns.find((function(t){return t.alias?t.alias===e:t.id===e}));if(!t&&r.isDevMode())return console.warn("Could not find column with alias "+e+' "'+e+'".'),{value:void 0};o.push(t)},s=this;try{for(var l=v(t),c=l.next();!c.done;c=l.next()){var u=c.value,d=a(u);if("object"==typeof d)return d.value}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}else o=t;this.ds.setFilter(e,o)}else this.ds.setFilter()},e.prototype.setDataSource=function(e){var n=this;if(this._dataSource!==e){this._dataSource&&I.kill(this,this._dataSource);var i=this._dataSource;this._dataSource=e,this._cdkTable.dataSource=e,this.setupPaginator(),this.setupNoData(!1),this._extApi.contextApi.clear(),this._plugin.emitEvent({kind:"onDataSource",prev:i,curr:e}),e&&(r.isDevMode()&&e.onError.pipe(I(this,e)).subscribe(console.error.bind(console)),e.onSourceChanging.pipe(I(this,e)).subscribe((function(){return n._extApi.contextApi.clear()})),e.onRenderDataChanging.pipe(o.filter((function(e){var t=e.event;return!t.isInitial&&(t.pagination.changed||t.sort.changed||t.filter.changed)})),o.tap((function(){return!n._store.primary&&n._extApi.contextApi.clear()})),o.switchMap((function(){return e.onRenderedDataChanged.pipe(o.take(1),o.mapTo(n.ds.renderLength))})),o.observeOn(t.asapScheduler),I(this,e)).subscribe((function(e){var t=n._extApi.cdkTable;e===n.ds.renderLength?t.syncRows(!0):(t.syncRows("header",!0),t.syncRows("footer",!0))})),e.onRenderedDataChanged.pipe(o.map((function(){return n.ds.renderLength})),o.startWith(null),o.pairwise(),o.tap((function(e){var t=m(e,2),r=(t[0],t[1]),i=!!n._noDateEmbeddedVRef;(r>0&&i||0===r&&!i)&&n.setupNoData()})),o.observeOn(t.animationFrameScheduler),I(this,e)).subscribe((function(){var e=n.viewport.elementRef.nativeElement;if(n.ds.renderLength>0&&n._fallbackMinHeight>0){var t=Math.min(n._fallbackMinHeight,n.viewport.measureRenderedContentSize());e.style.minHeight=t+"px"}else e.style.minHeight=n.viewport.enabled?null:n.viewport.measureRenderedContentSize()+"px"})))}},e.prototype.invalidateColumns=function(){this._plugin.emitEvent({kind:"beforeInvalidateHeaders"});var e=this._store.allColumns.length>0;this._extApi.contextApi.clear(),this._store.invalidate(this.columns),$e(this._store,this.__identityProp),this.attachCustomCellTemplates(),this.attachCustomHeaderCellTemplates(),this._cdkTable.clearHeaderRowDefs(),this._cdkTable.clearFooterRowDefs(),this.cdr.detectChanges(),this.resetHeaderRowDefs(),this.resetFooterRowDefs(),this.cdr.markForCheck(),e&&(this._cdkTable.multiTemplateDataRows=this._cdkTable.multiTemplateDataRows),this._plugin.emitEvent({kind:"onInvalidateHeaders"})},e.prototype.resetColumnsWidth=function(){P(this._store.getStaticWidth(),this._store.columns,this._store.metaColumns)},e.prototype.syncColumnGroupsSize=function(e){var t,r;e||(e=this._extApi.dynamicColumnWidthFactory());var n=function(t){var r=i._store.columns.filter((function(e){return!e.hidden&&e.isInGroup(t)})).map((function(e){return e.sizeInfo}));if(r.length>0){var n=e.addGroup(r);t.minWidth=n,t.updateWidth(n+"px")}else t.minWidth=void 0,t.updateWidth("0px")},i=this;try{for(var o=v(this._store.getAllHeaderGroup()),a=o.next();!a.done;a=o.next()){n(a.value)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.resizeColumns=function(e){var t=this;if(e||(e=this._store.columns),e[0].sizeInfo){var r=this._extApi.dynamicColumnWidthFactory();if(this.syncColumnGroupsSize(r),0===r.minimumRowWidth&&r.addGroup(e.map((function(e){return e.sizeInfo}))),r.maxWidthLockChanged)return P(this._store.getStaticWidth(),this._store.columns,this._store.metaColumns),void this.resizeColumns(e);this._minimumRowWidth||(this._cdkTable.minWidth=r.minimumRowWidth),this.ngZone.run((function(){t._cdkTable.syncRows("header"),t._plugin.emitEvent({kind:"onResizeRow"})}))}},e.prototype.createView=function(e,t,r,n){var i=this.getInternalVcRef(e).createEmbeddedView(t,r,n);return i.detectChanges(),i},e.prototype.removeView=function(e,t){var r=this.getInternalVcRef(t),n=r.indexOf(e);return-1!==n&&(r.remove(n),!0)},e.prototype.autoSizeColumnToFit=function(e){var t=this.viewport,r=t.innerWidth,n=t.outerWidth;this.columnApi.autoSizeToFit(n-(n-r),e)},e.prototype.findInitialRowHeight=function(){var e;if(this._cdkTable._rowOutlet.viewContainer.length){e=this._cdkTable._rowOutlet.viewContainer.get(0).rootNodes[0];var t=getComputedStyle(e).height;return parseInt(t,10)}if(this._vcRefBeforeContent){(e=(e=this._vcRefBeforeContent.length>0?this._vcRefBeforeContent.get(this._vcRefBeforeContent.length-1).rootNodes[0]:this._vcRefBeforeContent.element.nativeElement).nextElementSibling).style.display="";t=getComputedStyle(e).height;return e.style.display="none",parseInt(t,10)}},e.prototype.addClass=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var i=v(r),o=i.next();!o.done;o=i.next()){var a=o.value;this.elRef.nativeElement.classList.add(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.removeClass=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];try{for(var i=v(r),o=i.next();!o.done;o=i.next()){var a=o.value;this.elRef.nativeElement.classList.remove(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.initPlugins=function(e,t,n){var i,o=r.Injector.create({providers:[{provide:r.ViewContainerRef,useValue:n},{provide:r.ElementRef,useValue:t},{provide:r.ChangeDetectorRef,useValue:this.cdr}],parent:e});this._plugin=S.create(this,o,this._extApi),(i=this._plugin).events.subscribe((function(e){if("onDataSource"===e.kind){var t=e.curr,r=e.prev;r&&r.hostGrid===i.grid&&(r.hostGrid=void 0),t&&(t.hostGrid=i.grid)}else if("onDestroy"===e.kind){var n=i.grid.ds;n.hostGrid===i.grid&&(n.hostGrid=void 0)}}))},e.prototype.listenToResize=function(){var e,r=this,n=t.fromEventPattern((function(t){e||(e=new i(t)).observe(r.elRef.nativeElement)}),(function(t){e&&(e.unobserve(r.elRef.nativeElement),e.disconnect(),e=void 0)})),a=document.body.contains(this.elRef.nativeElement)?1:0;n.pipe(o.skip(a),o.debounceTime(0,t.animationFrameScheduler),I(this)).subscribe((function(e){0===a&&(a=1,r._store.columns.forEach((function(e){return e.sizeInfo.updateSize()})));r.onResize(e[0])}))},e.prototype.onResize=function(e){this._viewport&&this._viewport.checkViewportSize(),this.resizeColumns()},e.prototype.initExtApi=function(){var e=this,t=[],r={grid:this,element:this.elRef.nativeElement,get cdkTable(){return r.grid._cdkTable},get events(){return r.grid._plugin.events},get contextApi(){return Object.defineProperty(this,"contextApi",{value:new Fe(r)}),r.contextApi},get metaRowService(){return Object.defineProperty(this,"metaRowService",{value:new Ne(r)}),r.metaRowService},onInit:function(e){if(r.grid.isInit)e();else{if(0===t.length)var n=r.events.subscribe((function(e){var r,i;if("onInit"===e.kind){try{for(var o=v(t),a=o.next();!a.done;a=o.next()){(0,a.value)()}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}n.unsubscribe(),t=n=void 0}}));t.push(e)}},columnStore:this._store,setViewport:function(t){return e._viewport=t},dynamicColumnWidthFactory:function(){return new We(Ve)}};this._extApi=r},e.prototype.setupNoData=function(e){if(this._noDateEmbeddedVRef&&(this.removeView(this._noDateEmbeddedVRef,"beforeContent"),this._noDateEmbeddedVRef=void 0),!1!==e){var t=this._dataSource&&0===this._dataSource.renderLength;if(t?this.addClass("pbl-ngrid-empty"):this.removeClass("pbl-ngrid-empty"),t||!0===e){var r=this.registry.getSingle("noData");r&&(this._noDateEmbeddedVRef=this.createView("beforeContent",r.tRef,{$implicit:this},0))}}},e.prototype.getInternalVcRef=function(e){return"beforeTable"===e?this._vcRefBeforeTable:"beforeContent"===e?this._vcRefBeforeContent:this._vcRefAfterContent},e.prototype.setupPaginator=function(){var e=this.ds&&this.usePagination;if(e&&(this.ds.pagination=this._pagination,this.ds.paginator&&(this.ds.paginator.noCacheMode=this._noCachePaginator)),this.isInit&&(I.kill(this,"pblPaginationKillKey"),this._paginatorEmbeddedVRef&&(this.removeView(this._paginatorEmbeddedVRef,"beforeContent"),this._paginatorEmbeddedVRef=void 0),e)){var t=this.registry.getSingle("paginator");t&&(this._paginatorEmbeddedVRef=this.createView("beforeContent",t.tRef,{$implicit:this}))}},e.prototype.attachCustomCellTemplates=function(){var e,t;try{for(var r=v(this._store.columns),n=r.next();!n.done;n=r.next()){var i=n.value,o=ke(this.registry,i,"tableCell",!0);if(o)i.cellTpl=o.tRef;else{var a=this.registry.getMultiDefault("tableCell");i.cellTpl=a?a.tRef:this._fbTableCell}var s=ke(this.registry,i,"editorCell",!0);if(s)i.editorTpl=s.tRef;else{a=this.registry.getMultiDefault("editorCell");i.editorTpl=a?a.tRef:void 0}}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.attachCustomHeaderCellTemplates=function(){var e,t,r=[].concat(this._store.columns,this._store.metaColumns),n=this.registry.getMultiDefault("headerCell")||{tRef:this._fbHeaderCell},i=this.registry.getMultiDefault("footerCell")||{tRef:this._fbFooterCell};try{for(var o=v(r),a=o.next();!a.done;a=o.next()){var s=a.value;if(he(s)){var l=ke(this.registry,s,"headerCell",!0)||n,c=ke(this.registry,s,"footerCell",!0)||i;s.headerCellTpl=l.tRef,s.footerCellTpl=c.tRef}else{if(s.header){l=ke(this.registry,s.header,"headerCell",!0)||n;s.header.template=l.tRef}if(s.headerGroup){l=ke(this.registry,s.headerGroup,"headerCell",!0)||n;s.headerGroup.template=l.tRef}if(s.footer){c=ke(this.registry,s.footer,"footerCell",!0)||i;s.footer.template=c.tRef}}}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}},e.prototype.resetHeaderRowDefs=function(){var e,t;if(this._headerRowDefs){this._cdkTable.clearHeaderRowDefs();var r=this._headerRowDefs.toArray();r.push(r.shift());try{for(var n=v(r),i=n.next();!i.done;i=n.next()){var o=i.value;this._cdkTable.addHeaderRowDef(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}}},e.prototype.resetFooterRowDefs=function(){var e,t;if(this._footerRowDefs){this._cdkTable.clearFooterRowDefs();try{for(var r=v(this._footerRowDefs.toArray()),n=r.next();!n.done;n=r.next()){var i=n.value;this._cdkTable.addFooterRowDef(i)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}},e.decorators=[{type:r.Component,args:[{selector:"pbl-ngrid",template:'\x3c!-- GRID HEADER ROW DEF - THE MAIN HEADER OF THE GRID --\x3e\n<cdk-header-row *cdkHeaderRowDef="columnApi.visibleColumnIds; sticky: columnRowDef.header?.type === \'sticky\'"\n                [pblMetaRow]="columnRowDef.header"\n                data-rowtype="header"\n                class="pbl-ngrid-header-row pbl-ngrid-header-row-main"\n                [class.pbl-ngrid-row-hidden]="!showHeader"></cdk-header-row>\n\n\x3c!-- DUPLICATE HEADER FOR THE MAIN HEADER, NEVER SEEN (NOT VISUAL), USED FOR RESIZING --\x3e\n<cdk-header-row *cdkHeaderRowDef="columnApi.visibleColumnIds;"\n                [pblMetaRow]="columnRowDef.header" gridWidthRow\n                data-rowtype="header"\n                style="visibility: hidden !important;"\n                class="pbl-ngrid-header-row pbl-ngrid-row-visually-hidden"></cdk-header-row>\n\n\x3c!-- MULTI-HEADER ROW DEF & MULTI-HEADER GROUP ROW DEFINITION TEMPLATES --\x3e\n<ng-container *ngFor="let row of metaColumnIds.header;">\n  <cdk-header-row *cdkHeaderRowDef="row.keys; sticky: row.rowDef.type === \'sticky\'"\n                  [pblMetaRow]="row.rowDef"\n                  data-rowtype="meta-header" class="pbl-ngrid-header-row"\n                  [class.pbl-meta-group-row]="row.isGroup"></cdk-header-row>\n</ng-container>\n\n\x3c!-- GRID FOOTER ROW DEF --\x3e\n<cdk-footer-row *cdkFooterRowDef="columnApi.visibleColumnIds; sticky: columnRowDef.footer?.type === \'sticky\'"\n                [pblMetaRow]="columnRowDef.footer"\n                data-rowtype="footer"\n                class="pbl-ngrid-footer-row"\n                [class.pbl-ngrid-row-hidden]="!showFooter"></cdk-footer-row> \x3c!-- GRID FOOTER ROW DEF --\x3e\n\x3c!-- MULTI-FOOTER ROW DEF --\x3e\n<ng-container *ngFor="let row of metaColumnIds.footer">   \x3c!-- MULTI-FOOTER ROW DEF --\x3e\n  <cdk-footer-row *cdkFooterRowDef="row.keys; sticky: row.rowDef.type === \'sticky\'"\n                  [pblMetaRow]="row.rowDef"\n                  data-rowtype="meta-footer" class="pbl-ngrid-footer-row"\n                  [class.pbl-meta-group-row]="row.isGroup"></cdk-footer-row>\n</ng-container>\n\n<div class="pbl-ngrid-container">\n  <ng-container #beforeTable></ng-container>\n  <div pbl-ngrid-fixed-meta-row-container="header"></div>\n  <pbl-cdk-virtual-scroll-viewport class="pbl-ngrid-scroll-container"\n                                   [stickyRowHeaderContainer]="stickyRowHeaderContainer" [stickyRowFooterContainer]="stickyRowFooterContainer">\n    <pbl-cdk-table tabindex="-1">\n      \x3c!-- Row templates. The columns used are set at the row template level --\x3e\n\n      \x3c!-- MULTI-HEADER/FOOTER CELL DEF --\x3e\n      <ng-container *ngFor="let meta of metaColumns">\n        <ng-container *ngIf="(meta.header || meta.headerGroup) as c" [pblNgridColumnDef]="c">\n          <pbl-ngrid-header-cell #hCell="ngridHeaderCell" *cdkHeaderCellDef>\n            <ng-container *ngTemplateOutlet="c.template; context: hCell.cellCtx"></ng-container>\n          </pbl-ngrid-header-cell>\n        </ng-container>\n        <ng-container *ngIf="meta.footer as c" [pblNgridColumnDef]="c">\n          <pbl-ngrid-footer-cell #fCell="ngridFooterCell" *cdkFooterCellDef>\n            <ng-container *ngTemplateOutlet="c.template; context: fCell.cellCtx"></ng-container>\n          </pbl-ngrid-footer-cell>\n        </ng-container>\n      </ng-container>\n      \x3c!-- MULTI-HEADER/FOOTER CELL DEF --\x3e\n\n      \x3c!-- HEADER-RECORD-FOOTER CELL DEF --\x3e\n      <ng-container *ngFor="let c of columnApi.visibleColumns;" [pblNgridColumnDef]="c">\n        \x3c!-- GRID HEADER CELL DEF --\x3e\n        <pbl-ngrid-header-cell *cdkHeaderCellDef="let row" [observeSize]="c"></pbl-ngrid-header-cell>\n\n        \x3c!-- RECORD CELL DEF --\x3e\n        <pbl-ngrid-cell #cell="pblNgridCell" *cdkCellDef="let row; pblRowContext as pblRowContext"\n                        [rowCtx]="pblRowContext" [attr.tabindex]="cellFocus" [attr.id]="c.id">\n          <ng-container *ngTemplateOutlet="cell.cellCtx?.editing ? c.editorTpl : c.cellTpl; context: cell.cellCtx"></ng-container>\n        </pbl-ngrid-cell>\n\n        \x3c!-- GRID FOOTER CELL DEF --\x3e\n        <pbl-ngrid-footer-cell #fCell="ngridFooterCell" *cdkFooterCellDef>\n          <ng-container *ngTemplateOutlet="c.footerCellTpl; context: fCell.cellCtx"></ng-container>\n        </pbl-ngrid-footer-cell>\n      </ng-container>\n      \x3c!-- HEADER-RECORD-FOOTER CELL DEF --\x3e\n\n      \x3c!-- GRID RECORD ROW DEFINITION TEMPLATES --\x3e\n      <pbl-ngrid-row *cdkRowDef="let row; columns: columnApi.visibleColumnIds;" [row]="row"></pbl-ngrid-row>\n      \x3c!-- GRID RECORD ROW DEFINITION TEMPLATES --\x3e\n    </pbl-cdk-table>\n  </pbl-cdk-virtual-scroll-viewport>\n  <div pbl-ngrid-fixed-meta-row-container="footer"></div>\n  <ng-container #beforeContent>\n    \x3c!-- This dummy row is used to extract an initial row height --\x3e\n    <pbl-ngrid-row row style="display: none"></pbl-ngrid-row>\n  </ng-container>\n  <ng-content></ng-content>\n  <ng-container #afterContent></ng-container>\n\n  \x3c!-- Placeholder for header/footer scroll containers that will get populated with header/meta roles when the following conditions are met:\n       - Virtual scrolling is enabled\n       - Rows are rendered in the viewport\n       - Container is scrolling\n\n       The placeholder is fixed so the browsers does not use sticky positioning while scrolling, which takes the rows out of view while scrolling.\n       While scrolling the rows are moved into this placeholder and when scrolling ends they return to their original positioning.\n\n       The actual rows are added into the internal div, within the placeholder.\n       The top container get the proper width and the internal header gets the scroll offset (horizontal) that matches the current offset.\n       This has an effect only when scrolling with the wheel within a long scrolling session.\n\n       Implementation is in the virtual scroll viewport (more precisely in `PblVirtualScrollForOf`)\n  --\x3e\n  <div #stickyRowHeaderContainer class="pbl-ngrid-sticky-row-scroll-container"><div [style.minWidth.px]="_cdkTable?.minWidth"></div></div> \x3c!-- HEADERS --\x3e\n  <div #stickyRowFooterContainer class="pbl-ngrid-sticky-row-scroll-container"><div [style.minWidth.px]="_cdkTable?.minWidth"></div></div> \x3c!-- FOOTERS --\x3e\n</div>\n\n<ng-template #fbTableCell let-value="value"><div>{{value}}</div></ng-template>\n<ng-template #fbHeaderCell let-column="col"><div>{{column.label}}</div></ng-template>\n<ng-template #fbFooterCell let-column="col"><div>{{column.label}}</div></ng-template>\n',providers:[we,{provide:k,useFactory:Ge,deps:[r.forwardRef((function(){return e}))]},{provide:D,useFactory:Be,deps:[r.forwardRef((function(){return e}))]},{provide:Ne,useFactory:qe,deps:[r.forwardRef((function(){return e}))]}],changeDetection:r.ChangeDetectionStrategy.OnPush,encapsulation:r.ViewEncapsulation.None,styles:["pbl-ngrid{display:block}.pbl-ngrid-row-visually-hidden{border-top:0;border-bottom:0;clip:rect(0 0 0 0);height:0;min-height:0;max-height:0;overflow:hidden!important;visibility:collapse!important;outline:0;-webkit-appearance:none;-moz-appearance:none}.pbl-ngrid-row-hidden{display:none!important}.pbl-ngrid-container{position:relative;height:100%;width:100%;flex-direction:column;box-sizing:border-box;display:flex;overflow:auto;min-height:inherit}.pbl-ngrid-scroll-container{flex:1 1 auto;box-sizing:border-box;min-height:auto}.pbl-ngrid-scroll-container.cdk-virtual-scroll-disabled{flex:1 0 auto}.pbl-ngrid-sticky-row-scroll-container{position:fixed;overflow:hidden}.pbl-ngrid-empty-spacer{display:none}.pbl-ngrid-empty .cdk-virtual-scroll-content-wrapper{min-height:100%;display:flex;flex-direction:column}.pbl-ngrid-empty .cdk-virtual-scroll-content-wrapper .pbl-cdk-table{display:flex;flex-direction:column;flex:1 1 100%}.pbl-ngrid-empty .cdk-virtual-scroll-content-wrapper .pbl-cdk-table>*{flex:0 0 auto}.pbl-ngrid-empty .cdk-virtual-scroll-content-wrapper .pbl-cdk-table>.pbl-ngrid-empty-spacer{display:block;flex:1 1 auto}.pbl-ngrid-scrolling pbl-cdk-table{pointer-events:none}"]}]}],e.ctorParameters=function(){return[{type:r.Injector},{type:r.ViewContainerRef},{type:r.ElementRef},{type:r.IterableDiffers},{type:r.NgZone},{type:r.ChangeDetectorRef},{type:_},{type:we},{type:String,decorators:[{type:r.Attribute,args:["id"]}]}]},e.propDecorators={showHeader:[{type:r.Input}],showFooter:[{type:r.Input}],noFiller:[{type:r.Input}],focusMode:[{type:r.Input}],identityProp:[{type:r.Input}],dataSource:[{type:r.Input}],usePagination:[{type:r.Input}],noCachePaginator:[{type:r.Input}],columns:[{type:r.Input}],hideColumns:[{type:r.Input}],fallbackMinHeight:[{type:r.Input}],rowClassUpdate:[{type:r.Input}],rowClassUpdateFreq:[{type:r.Input}],_vcRefBeforeTable:[{type:r.ViewChild,args:["beforeTable",{read:r.ViewContainerRef,static:!0}]}],_vcRefBeforeContent:[{type:r.ViewChild,args:["beforeContent",{read:r.ViewContainerRef,static:!0}]}],_vcRefAfterContent:[{type:r.ViewChild,args:["afterContent",{read:r.ViewContainerRef,static:!0}]}],_fbTableCell:[{type:r.ViewChild,args:["fbTableCell",{read:r.TemplateRef,static:!0}]}],_fbHeaderCell:[{type:r.ViewChild,args:["fbHeaderCell",{read:r.TemplateRef,static:!0}]}],_fbFooterCell:[{type:r.ViewChild,args:["fbFooterCell",{read:r.TemplateRef,static:!0}]}],_tableRowDef:[{type:r.ViewChild,args:[n.CdkRowDef,{static:!0}]}],_headerRowDefs:[{type:r.ViewChildren,args:[n.CdkHeaderRowDef]}],_footerRowDefs:[{type:r.ViewChildren,args:[n.CdkFooterRowDef]}]},e}();
/**
     * @license
     * Copyright Google Inc. All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
var Ze=function(){function e(e,t){this._name=e,this._options=t,this.value=null,this._lastSetValue=null,this._lastSetValueType=0,this._lastSetValueIdentityChange=!1}return e.prototype.setValue=function(e){if(Array.isArray(e))this._lastSetValueType=4;else if(e instanceof Set)this._lastSetValueType=8;else if(e&&"string"==typeof e){if(!(4&this._options))throw new Error(this._name+" string values are not allowed");this._lastSetValueType=1}else this._lastSetValueType=e?2:0;this._lastSetValueIdentityChange=!0,this._lastSetValue=e||null},e.prototype.hasValueChanged=function(){var e=this._lastSetValueIdentityChange;if(!(e||14&this._lastSetValueType))return!1;var t=null,r=!!(1&this._options),n=!!(8&this._options),i=!!(2&this._options);switch(this._lastSetValueType){case 1:var o=this._lastSetValue.split(/\s+/g);16&this._options?(t={},o.forEach((function(e,r){return t[e]=!0}))):t=o.reduce((function(e,t,r){return e+(r?" ":"")+t}));break;case 2:var a=this._lastSetValue,s=Object.keys(a);e||(e=!this.value||function(e,t,r){var n=Object.keys(t),i=e;if(!Qe(n,i))return!0;for(var o=0;o<i.length;o++){var a=i[o];if(t[a]!==r[a])return!0}return!1}(s,this.value,a)),e&&(t=Ye(this._name,r,n,i,a,s));break;case 4:case 8:var l=Array.from(this._lastSetValue);if(!e)e=!Qe(Object.keys(this.value),l);e&&(t=Ye(this._name,r,n,i,l));break;default:t=null}return e&&(this.value=t),e},e}();function Ye(e,t,r,n,i,o){var a={};if(o)for(var s=0;s<o.length;s++){var l=o[s];Je(a,l=t?l.trim():l,c=i[l],r,n)}else for(s=0;s<i.length;s++){var c;Ke(e,c=i[s]),Je(a,c=t?c.trim():c,!0,!1,n)}return a}function Ke(e,t){if("string"!=typeof t)throw new Error(e+" can only toggle CSS classes expressed as strings, got "+t)}function Je(e,t,r,n,i){if(i&&t.indexOf(" ")>0)for(var o=t.split(/\s+/g),a=0;a<o.length;a++)Xe(e,o[a],r,n);else Xe(e,t,r,n)}function Xe(e,t,r,n){if(n){var i=function(e,t){var r=e.indexOf(".");if(r>0){var n=e.substr(r+1);e=e.substring(0,r),null!=t&&(t+=n)}return{key:e,value:t}}(t,r);r=i.value,t=i.key}e[t]=r}function Qe(e,t){if(e&&t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(-1===t.indexOf(e[r]))return!1;return!0}return!1}var et='<ng-content select=".pbl-ngrid-row-prefix"></ng-content>'+n.CDK_ROW_TEMPLATE+'<ng-content select=".pbl-ngrid-row-suffix"></ng-content>',tt=function(e){function t(t,r){var n=e.call(this)||this;return n.extApi=t,n.el=r,t&&(n.grid=t.grid),n}return g(t,e),Object.defineProperty(t.prototype,"row",{set:function(e){e&&this.updateRow()},enumerable:!0,configurable:!0}),t.prototype.updateRow=function(){this.extApi&&(this.rowRenderIndex>=0||this.getRend(),this.context=this.extApi.contextApi.rowContext(this.rowRenderIndex),this.el.nativeElement.setAttribute("row-id",this.context.dataIndex),this.el.nativeElement.setAttribute("row-key",this.context.identity),this.grid.rowClassUpdate&&"item"===this.grid.rowClassUpdateFreq&&this.updateHostClass())},t.prototype.ngDoCheck=function(){this.grid.rowClassUpdate&&"ngDoCheck"===this.grid.rowClassUpdateFreq&&this.updateHostClass()},t.prototype.ngOnChanges=function(e){if(!this.extApi){if(!this.grid)throw new Error('"pbl-ngrid-row" is used outside the scope of a grid, you must provide a grid instance.');var t=k.find(this.grid);this.extApi=t.extApi,this.updateRow()}},t.prototype.getRend=function(){for(var e=this.extApi.cdkTable._rowOutlet.viewContainer,t=e.length-1;t>-1;t--){if(e.get(t).rootNodes[0]===this.el.nativeElement){this.rowRenderIndex=t;break}}},t.prototype.updateHostClass=function(){var e,t,r,n,i,o;if(this.context){var a=this.el.nativeElement;if(this.grid.rowClassUpdate){this._classDiffer||(this._classDiffer=new Ze("NgClass",23),this._lastClass=new Set);var s=this.grid.rowClassUpdate(this.context);if(this._classDiffer.setValue(s),this._classDiffer.hasValueChanged()){var l=this._lastClass;this._lastClass=new Set;var c=this._classDiffer.value||{};try{for(var u=v(Object.keys(c)),d=u.next();!d.done;d=u.next()){c[f=d.value]?(a.classList.add(f),this._lastClass.add(f)):a.classList.remove(f),l.delete(f)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}if(l.size>0)try{for(var h=v(l.values()),p=h.next();!p.done;p=h.next()){var f=p.value;a.classList.remove(f)}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}}}else if(this._classDiffer){c=this._classDiffer.value||{};this._classDiffer=this._lastClass=void 0;try{for(var g=v(Object.keys(c)),y=g.next();!y.done;y=g.next()){f=y.value;a.classList.remove(f)}}catch(e){i={error:e}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}}}},t.decorators=[{type:r.Component,args:[{selector:"pbl-ngrid-row[row]",template:et,host:{class:"pbl-ngrid-row",role:"row"},providers:[{provide:n.CdkRow,useExisting:t}],exportAs:"pblNgridRow",changeDetection:r.ChangeDetectionStrategy.OnPush,encapsulation:r.ViewEncapsulation.None}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:r.Optional},{type:r.Inject,args:[D]}]},{type:r.ElementRef}]},t.propDecorators={row:[{type:r.Input}],grid:[{type:r.Input}]},t}(n.CdkRow);var rt=function(){function e(e,t){this.tRef=e,this.registry=t}return e.prototype.ngOnInit=function(){this.registry.setSingle(this.kind,this)},e.prototype.ngOnDestroy=function(){this.registry.setSingle(this.kind,void 0)},e}();var nt=function(){function e(e,t){this.tRef=e,this.registry=t}return e.prototype.ngOnInit=function(){this.registry.addMulti(this.kind,this)},e.prototype.ngOnDestroy=function(){this.registry.removeMulti(this.kind,this)},e}();var it=function(){};var ot=function(e){function t(){return e.call(this)||this}return g(t,e),t.createDateHeaderCtx=function(e,r){var n=new t;return n.col=e.columnDef.column,n.grid=e.grid,Object.defineProperty(n,"injector",{value:r}),n},t}(De);var at=function(e){function t(r,n){var i=e.call(this,r,n)||this;return i.name="genericHeaderExtension-"+t._id++,i.kind="dataHeaderExtensions",i}return g(t,e),t._id=0,t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridHeaderExtensionRef]"}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:we}]},t.propDecorators={shouldRender:[{type:r.Input,args:["pblNgridHeaderExtensionRef"]}]},t}(nt);var st=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.kind="paginator",n}return g(t,e),t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridPaginatorRef]"}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:we}]},t}(rt);var lt=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.kind="noData",n}return g(t,e),t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridNoDataRef]"}]}],t.ctorParameters=function(){return[{type:r.TemplateRef},{type:we}]},t}(rt);var ct=function(){function e(e,t){this.grid=e,this.tRef=t}return e.prototype.ngAfterViewInit=function(){this.grid.createView("bottom"===this.position?"beforeContent":"beforeTable",this.tRef)},e.decorators=[{type:r.Directive,args:[{selector:"[pblNgridOuterSection]",inputs:["position:pblNgridOuterSection"]}]}],e.ctorParameters=function(){return[{type:Ue},{type:r.TemplateRef}]},e}();function ut(e){return"pbl-ngrid-column-"+e.cssClassFriendlyName}var dt=function(e){function t(t){var n=e.call(this)||this;n.extApi=t,n.isDragging=!1,n.widthChange=new r.EventEmitter,n._widths=[],n.grid=n.table=t.grid;var i=t.dynamicColumnWidthFactory().strategy;return n.widthBreakout=function(e){return Me(i,e)},n}return g(t,e),Object.defineProperty(t.prototype,"column",{get:function(){return this._column},set:function(e){this.attach(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"widths",{get:function(){return this._widths[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"netWidth",{get:function(){return this._netWidth},enumerable:!0,configurable:!0}),t.prototype.updateWidth=function(e,t){var r=this._column,n=r.isFixedWidth,i=r.parsedWidth,o=n?Math.max(this._column.parsedWidth.value,this._column.minWidth||0):this._column.minWidth,a=o&&o+"px";!a&&i&&"%"===i.type&&(a=e);var s=n?Math.min(this._column.parsedWidth.value,this._column.maxWidth||this._column.parsedWidth.value):this._column.maxWidth,l=[a||"",e,s?s+"px":e];if("resize"===t)this._widths[1]=l,this.widthChange.emit({reason:t});else{var c=this._widths[0]||[];this._widths[0]=l,this._widths[1]||(this._widths[1]=l);for(var u=0;u<3;u++)if(c[u]!==l[u]){this.widthChange.emit({reason:t});break}}},t.prototype.applyWidth=function(e){ht(e,this.widths)},t.prototype.applySourceWidth=function(e){ht(e,this._widths[0])},t.prototype.queryCellElements=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i="."+ut(this),o=[];if(0===r.length)o.push(i);else try{for(var a=v(r),s=a.next();!s.done;s=a.next()){var l=s.value;switch(l){case"table":o.push(".pbl-ngrid-cell"+i);break;case"header":o.push(".pbl-ngrid-header-cell"+i+":not(.pbl-header-group-cell)");break;case"headerGroup":o.push(".pbl-header-group-cell"+i);break;case"footer":o.push(".pbl-ngrid-footer-cell"+i+":not(.pbl-footer-group-cell)");break;case"footerGroup":o.push(".pbl-footer-group-cell"+i)}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return 0===o.length?[]:Array.from(this.extApi.element.querySelectorAll(o.join(", ")))},t.prototype.ngOnDestroy=function(){this.detach(),this.widthChange.complete()},t.prototype.onResize=function(){if(he(this.column)){var e=this._netWidth;if(this._netWidth=this.widthBreakout(this.column.sizeInfo).content,e!==this._netWidth){var t=this._netWidth+"px";this.updateWidth(t,"resize")}}},t.prototype.updatePin=function(e){switch(this.sticky=this.stickyEnd=!1,e){case"start":this.sticky=!0;break;case"end":this.stickyEnd=!0}this.grid.isInit&&this.grid._cdkTable.updateStickyColumnStyles()},t.prototype.attach=function(e){this._column!==e&&(this.detach(),e&&(this._column=e,e.attach(this),this.name=e.id.replace(/ /g,"_"),he(e)&&this.updatePin(e.pin)))},t.prototype.detach=function(){this._column&&(this._column.detach(),this._column=void 0)},t.decorators=[{type:r.Directive,args:[{selector:"[pblNgridColumnDef]",providers:[{provide:n.CdkColumnDef,useExisting:t},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:t}]}]}],t.ctorParameters=function(){return[{type:void 0,decorators:[{type:r.Inject,args:[D]}]}]},t.propDecorators={column:[{type:r.Input,args:["pblNgridColumnDef"]}],widthChange:[{type:r.Output,args:["pblNgridColumnDefWidthChange"]}]},t}(n.CdkColumnDef);function ht(e,t){e.style.minWidth=t[0],e.style.width=t[1],e.style.maxWidth=t[2],t[0]&&t[0].endsWith("%")?e.style.boxSizing="border-box":e.style.boxSizing="content-box"}function pt(e,t){var r,n;if(e.classList.add(ut(t.columnDef)),t.type&&e.classList.add("pbl-ngrid-column-type-"+t.type.name),t.css){var i=t.css.split(" ");try{for(var o=v(i),a=o.next();!a.done;a=o.next()){var s=a.value;e.classList.add(s)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}}var ft=new Map;function gt(){this.columnDef.applyWidth(this.el)}function yt(){this.columnDef.applySourceWidth(this.el)}var vt=function(e){function t(t,r,n,i){var o=e.call(this,t,n)||this;o.columnDef=t,o.grid=r,o.elementRef=n,o.zone=i,o.table=r;var a=t.column,s=o.el=n.nativeElement;return ae(a)&&(s.classList.add("pbl-header-group-cell"),a.placeholder&&s.classList.add("pbl-header-group-cell-placeholder")),o}return g(t,e),t.prototype.ngOnInit=function(){var e,t,r,n=this.columnDef.column;if(he(n)){var i=this.el.parentElement.hasAttribute("gridWidthRow");r=i?yt:gt,e=function(e){return!i&&"update"!==e.reason||i&&"resize"!==e.reason},t=i?void 0:this.initMainHeaderColumnView(n)}else r=yt,e=function(e){return"resize"!==e.reason},t=this.initMetaHeaderColumnView(n);this.columnDef.widthChange.pipe(o.filter(e),I(this)).subscribe(r.bind(this)),t&&t.detectChanges(),r.call(this),pt(this.el,n)},t.prototype.ngOnDestroy=function(){I.kill(this)},t.prototype.initMainHeaderColumnView=function(e){var t=this;this.cellCtx=ot.createDateHeaderCtx(this,this.vcRef.injector);var r=this.cellCtx,n=this.vcRef.createEmbeddedView(e.headerCellTpl,r);return this.zone.onStable.pipe(o.first()).subscribe((function(){t.runHeaderExtensions(r,n);var e=t.vcRef.get(0);e.destroyed||e.detectChanges()})),n},t.prototype.initMetaHeaderColumnView=function(e){return this.cellCtx=De.create(e,this.grid),this.vcRef.createEmbeddedView(e.template,this.cellCtx)},t.prototype.runHeaderExtensions=function(e,t){var r,n,i=this,a=ft.get(this.grid);if(!a){var s=new Map;this.grid.registry.forMulti("dataHeaderExtensions",(function(e){var t,r;try{for(var n=v(e),i=n.next();!i.done;i=n.next()){var o=i.value;s.has(o.name)||s.set(o.name,o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}})),a=Array.from(s.values()),ft.set(this.grid,a),this.zone.onStable.pipe(o.first()).subscribe((function(){return ft.delete(i.grid)}))}var l=t.rootNodes;try{for(var c=v(a),u=c.next();!u.done;u=c.next()){var d=u.value;if(!d.shouldRender||d.shouldRender(e))if(d instanceof nt)this.vcRef.createEmbeddedView(d.tRef,e).markForCheck();else d instanceof it&&(l=this.createComponent(d,e,l))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}},t.prototype.createComponent=function(e,t,r){var n=e.getFactory(t),i=[];e.projectContent&&i.push(r);var o=this.vcRef.createComponent(n,this.vcRef.length,null,i);return e.projectContent&&(r=[o.location.nativeElement]),e.onCreated&&e.onCreated(t,o),r},t.decorators=[{type:r.Component,args:[{selector:"pbl-ngrid-header-cell",host:{class:"pbl-ngrid-header-cell",role:"columnheader"},exportAs:"ngridHeaderCell",template:"<ng-container #vcRef></ng-container>",changeDetection:r.ChangeDetectionStrategy.OnPush,encapsulation:r.ViewEncapsulation.None}]}],t.ctorParameters=function(){return[{type:dt},{type:Ue},{type:r.ElementRef},{type:r.NgZone}]},t.propDecorators={vcRef:[{type:r.ViewChild,args:["vcRef",{read:r.ViewContainerRef,static:!0}]}]},t}(n.CdkHeaderCell);var mt=function(e){function t(t,r){var n,i,a=e.call(this,t,r)||this;return a.colDef=t,a.focused=!1,a.selected=!1,a.colIndex=a.colDef.grid.columnApi.indexOf(t.column),a.el=r.nativeElement,t.applyWidth(a.el),pt(a.el,t.column),n=a.el,(i=t.column).editable&&i.editorTpl&&n.classList.add("pbl-ngrid-editable-cell"),t.widthChange.pipe(o.filter((function(e){return"update"!==e.reason})),I(a)).subscribe((function(e){return a.colDef.applyWidth(a.el)})),a}return g(t,e),Object.defineProperty(t.prototype,"rowCtx",{set:function(e){e!==this._rowCtx&&(this._rowCtx=e,this.ngDoCheck())},enumerable:!0,configurable:!0}),t.prototype.ngDoCheck=function(){if(this._rowCtx){var e=this.cellCtx=this._rowCtx.cell(this.colIndex);e.focused!==this.focused&&((this.focused=e.focused)?this.el.classList.add("pbl-ngrid-cell-focused"):this.el.classList.remove("pbl-ngrid-cell-focused")),this.cellCtx.selected!==this.selected&&((this.selected=e.selected)?this.el.classList.add("pbl-ngrid-cell-selected"):this.el.classList.remove("pbl-ngrid-cell-selected"))}},t.prototype.ngOnDestroy=function(){I.kill(this)},t.decorators=[{type:r.Directive,args:[{selector:"pbl-ngrid-cell",host:{class:"pbl-ngrid-cell",role:"gridcell"},exportAs:"pblNgridCell"}]}],t.ctorParameters=function(){return[{type:dt},{type:r.ElementRef}]},t.propDecorators={rowCtx:[{type:r.Input}]},t}(n.CdkCell);var bt=function(e){function t(t,r,n){var i=e.call(this,t,n)||this;i.columnDef=t,i.grid=r,i.table=r,i.el=n.nativeElement;var a=t.column;return gt.call(i),pt(i.el,a),t.widthChange.pipe(o.filter((function(e){return"update"!==e.reason})),I(i)).subscribe(gt.bind(i)),i}return g(t,e),t.prototype.ngOnInit=function(){this.cellCtx=De.create(this.columnDef.column,this.grid)},t.prototype.ngOnDestroy=function(){I.kill(this)},t.decorators=[{type:r.Directive,args:[{selector:"pbl-ngrid-footer-cell",host:{class:"pbl-ngrid-footer-cell",role:"gridcell"},exportAs:"ngridFooterCell"}]}],t.ctorParameters=function(){return[{type:dt},{type:Ue},{type:r.ElementRef}]},t}(n.CdkFooterCell);var wt=function(){function e(e){this.elRef=e,this._lastStyle=new Set,this._lastClass=new Set}return Object.defineProperty(e.prototype,"style",{set:function(e){this._styleDiffer||(this._styleDiffer=new Ze("NgStyle",8)),this._styleDiffer.setValue(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"klass",{set:function(e){this._classDiffer||(this._classDiffer=new Ze("NgClass",23)),this._classDiffer.setValue(e)},enumerable:!0,configurable:!0}),e.prototype.ngAfterViewInit=function(){this._parent=this.elRef.nativeElement.parentElement,this.updateParent()},e.prototype.ngDoCheck=function(){this.updateParent()},e.prototype.updateParent=function(){var e,t,r,n,i,o,a,s;if(this._parent){if(this._styleDiffer&&this._styleDiffer.hasValueChanged()){var l=this._lastStyle;this._lastStyle=new Set;try{for(var c=v(Object.keys(this._styleDiffer.value)),u=c.next();!u.done;u=c.next()){var d=u.value;this._parent.style[d]=this._styleDiffer.value[d],l.delete(d),this._lastStyle.add(d)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}if(l.size>0)try{for(var h=v(l.values()),p=h.next();!p.done;p=h.next()){d=p.value;this._parent.style[d]=null}}catch(e){r={error:e}}finally{try{p&&!p.done&&(n=h.return)&&n.call(h)}finally{if(r)throw r.error}}}if(this._classDiffer&&this._classDiffer.hasValueChanged()){var f=this._lastClass;this._lastClass=new Set;try{for(var g=v(Object.keys(this._classDiffer.value)),y=g.next();!y.done;y=g.next()){d=y.value;this._classDiffer.value[d]?(this._parent.classList.add(d),this._lastClass.add(d)):this._parent.classList.remove(d),f.delete(d)}}catch(e){i={error:e}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}if(f.size>0)try{for(var m=v(f.values()),b=m.next();!b.done;b=m.next()){d=b.value;this._parent.classList.remove(d)}}catch(e){a={error:e}}finally{try{b&&!b.done&&(s=m.return)&&s.call(m)}finally{if(a)throw a.error}}}}},e.decorators=[{type:r.Directive,args:[{selector:"[ngridCellStyle], [ngridCellClass]"}]}],e.ctorParameters=function(){return[{type:r.ElementRef}]},e.propDecorators={style:[{type:r.Input,args:["ngridCellStyle"]}],klass:[{type:r.Input,args:["ngridCellClass"]}]},e}();var Ct=function(){function e(e,t){this.elRef=e,this.ngZone=t}return e.prototype.ngAfterViewInit=function(){var e=this,t=function(){var t=e.context;t.rowContext.updateOutOfViewState(),t.editing&&!t.rowContext.outOfView&&e.elRef.nativeElement.focus()};this.ngZone.runOutsideAngular((function(){Promise.resolve().then((function(){if(!e._destroyed){var r=e.context.grid.viewport;r&&r.isScrolling?r.scrolling.pipe(o.take(1)).subscribe(t):t()}}))}))},e.prototype.ngOnDestroy=function(){this._destroyed=!0},e.decorators=[{type:r.Directive,args:[{selector:"[pblCellEditAutoFocus]"}]}],e.ctorParameters=function(){return[{type:r.ElementRef},{type:r.NgZone}]},e.propDecorators={context:[{type:r.Input,args:["pblCellEditAutoFocus"]}]},e}();function _t(e,t,r){return[{start:e.start,end:t},{start:Math.max(0,e.start-t),end:Math.max(0,e.end-t)},{start:0,end:Math.max(0,e.end-(r+t))}]}function xt(e,t,r,n){var i="top"===n?-1:1,o=0;for(var a in 1===i&&(t=t.slice().reverse()),t)if(r[a]){var s=t[a];s.style[n]=i*(e+i*o)+"px",o+=s.getBoundingClientRect().height,s.style.display=null}}function Rt(e,t){var r=t;if(!r.getBoundingClientRect)return 0;var n=r.getBoundingClientRect();return"horizontal"==e?n.width:n.height}var St=function(){function e(e,t,r){this.viewport=e,this.viewPortEl=t,this.metaRows=r,this.runningHeader=!1,this.runningFooter=!1,this.canMoveHeader=!0,this.canMoveFooter=!0,this.movedFooterRows=[],this.movedHeaderRows=[]}return e.prototype.canMove=function(){return this.canMoveHeader||this.canMoveFooter},e.prototype.isRunning=function(){return this.runningHeader||this.runningFooter},e.prototype.move=function(e,t){return this.moveHeader(e,t),this.moveFooter(e,t),this.isRunning()&&!this.canMoveHeader&&!this.canMoveFooter},e.prototype.restore=function(e){var t=this.metaRows,r=t.header,n=t.footer;this.restoreHeader()&&xt(e,r.rows,r.sticky,"top"),this.restoreFooter()&&xt(e,n.rows,n.sticky,"bottom")},e.prototype.moveHeader=function(e,t){if(!this.runningHeader||this.canMoveHeader){this.runningHeader=!0,this.canMoveHeader=!1;for(var r=[],n=this.metaRows.header,i=void 0,o=0,a=n.rows.length;o<a;o++){var s=n.rows[o];if(n.sticky[o]){var l=s.getBoundingClientRect();if(n.rendered[o]){var c=l.top-t.top-e;if(c>=0||-c<t.height)return void(this.canMoveHeader=!0)}i||(i=l),r.push(o)}}r.length&&(this.viewport.stickyRowHeaderContainer.style.top=i.top+"px",this.cloneAndMoveRow(this.viewport.stickyRowHeaderContainer,n.rows,r,this.movedHeaderRows))}},e.prototype.moveFooter=function(e,t){if(!this.runningFooter||this.canMoveFooter){this.runningFooter=!0,this.canMoveFooter=!1;for(var r=[],n=this.metaRows.footer,i=void 0,o=0,a=n.rows.length;o<a;o++){var s=n.rows[o];if(n.sticky[o]){var l=s.getBoundingClientRect();if(n.rendered[o]){var c=l.bottom-t.bottom+e;if(c>=0&&c<t.height)return void(this.canMoveFooter=!0)}i=l,r.push(o)}}r.length&&(this.viewport.stickyRowFooterContainer.style.bottom="calc(100% - "+i.bottom+"px)",this.cloneAndMoveRow(this.viewport.stickyRowFooterContainer,n.rows,r,this.movedFooterRows))}},e.prototype.restoreHeader=function(){if(this.runningHeader){var e=this.movedHeaderRows;return this.movedHeaderRows=[],this.restoreRows(e,this.metaRows.header.rows),this.runningHeader=!1,this.canMoveHeader=!0,!0}return!1},e.prototype.restoreFooter=function(){if(this.runningFooter){var e=this.movedFooterRows;return this.movedFooterRows=[],this.restoreRows(e,this.metaRows.footer.rows),this.runningFooter=!1,this.canMoveFooter=!0,!0}return!1},e.prototype.cloneAndMoveRow=function(e,t,r,n){var i,o,a=e.firstElementChild;e.style.width=this.viewport.innerWidth+"px",a.style.transform="translateX(-"+this.viewPortEl.scrollLeft+"px)";try{for(var s=v(r),l=s.next();!l.done;l=s.next()){var c=l.value,u=t[c],d=u.cloneNode();d.style.width="0",u.style.top=u.style.bottom=u.style.position="",u.parentElement.insertBefore(d,u),a.appendChild(u),n.push([u,d,c]),t[c]=d}}catch(e){i={error:e}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}},e.prototype.restoreRows=function(e,t){var r,n;try{for(var i=v(e),o=i.next();!o.done;o=i.next()){var a=m(o.value,3),s=a[0],l=a[1],c=a[2];s.style.position=l.style.position,s.style.zIndex=l.style.zIndex,s.style.top=l.style.top,s.style.bottom=l.style.bottom,l.parentElement.insertBefore(s,l),l.parentElement.removeChild(l),t[c]=s}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e}();function kt(e,t){return e.index-t.index}var Dt=function(){function e(e,r){var n=this;this.ngZone=r,this.destroyed=new t.Subject,this.renderedContentOffset=0,this.metaRows=[0,0],this.header={rows:[],sticky:[],rendered:[]},this.footer={rows:[],sticky:[],rendered:[]},this.grid=e.grid,this.cdkTable=e.cdkTable,this.viewport=e.grid.viewport,this.viewChange=this.cdkTable.viewChange,k.find(e.grid).events.pipe(o.takeUntil(this.destroyed)).subscribe((function(e){"onDataSource"===e.kind&&(n.detachView(),n.attachView(e.curr))})),this.attachView(e.grid.ds),e.metaRowService.sync.pipe(o.takeUntil(this.destroyed)).subscribe((function(){var t=e.metaRowService.header.row.concat(e.metaRowService.header.sticky).sort(kt),r=e.metaRowService.footer.row.concat(e.metaRowService.footer.sticky).sort(kt);n.header.rows=t.map((function(e){return e.el})),n.header.sticky=t.map((function(e){return"sticky"===e.rowDef.type})),n.footer.rows=r.map((function(e){return e.el})),n.footer.sticky=r.map((function(e){return"sticky"===e.rowDef.type})),xt(n.renderedContentOffset,n.header.rows,n.header.sticky,"top"),xt(n.renderedContentOffset,n.footer.rows,n.footer.sticky,"bottom")}));var i,a=0,s=this.viewport.elementRef.nativeElement,l=new St(this.viewport,s,{header:this.header,footer:this.footer}),c=function(){return s.addEventListener("wheel",h,!0)},u=function(){return s.removeEventListener("wheel",h,!0)},d=function(){return i=n.viewport.measureScrollOffset()/(n.viewport.scrollHeight-n.viewport.getViewportSize())},h=function(e){if(e.deltaY){if(1===i&&e.deltaY>0||0===a&&e.deltaY<0)return;var r=a+e.deltaY;if((r=Math.min(n.viewport.scrollHeight,Math.max(0,r)))!==a&&(a=r,l.canMove()&&l.move(e.deltaY,s.getBoundingClientRect()))){var h=n.viewport.scrolling.pipe(o.filter((function(e){return!e}))),p=function(){l.restore(n.renderedContentOffset),d()},f=!1;if("blocking"!==n.viewport.wheelMode){var g=n.viewport.wheelMode;"passive"===g?(u(),n.viewport.scrolling.pipe(o.debounceTime(150),o.filter((function(e){return!e})),o.take(1)).subscribe((function(){p(),c()}))):n.viewport.scrollFrameRate.pipe(o.takeUntil(h.pipe(o.take(1)))).subscribe((function(e){!f&&e<g&&(u(),f=!0)}),null,(function(){var e=t.fromEvent(s,"wheel").pipe(o.debounceTime(50),o.take(1));t.race(e,t.timer(51)).subscribe((function(){p(),f&&c()}))}))}else h.pipe(o.take(1)).subscribe(p)}return n.viewport.scrollToOffset(a),e.preventDefault(),e.stopPropagation(),!0}};d(),c(),this.viewport.scrolling.subscribe((function(e){e||(a=n.viewport.measureScrollOffset())})),this.viewport.offsetChange.pipe(o.takeUntil(this.destroyed)).subscribe((function(e){n.renderedContentOffset!==e&&(n.renderedContentOffset=e,xt(e,n.header.rows,n.header.sticky,"top"),xt(e,n.footer.rows,n.footer.sticky,"bottom"))}))}return Object.defineProperty(e.prototype,"headerLength",{get:function(){return this.header.rows.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowLength",{get:function(){return this.vcRefs.data.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerLength",{get:function(){return this.footer.rows.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vcRefs",{get:function(){var e={header:this.cdkTable._headerRowOutlet.viewContainer,data:this.cdkTable._rowOutlet.viewContainer,footer:this.cdkTable._footerRowOutlet.viewContainer};return Object.defineProperty(this,"vcRefs",{value:e,configurable:!0}),e},enumerable:!0,configurable:!0}),e.prototype.measureRangeSize=function(e,t){if(e.start>=e.end)return 0;var r=this._renderedRanges,n=_t(e,this.metaRows[0],this.ds.length),i=[this.header.sticky,[],this.footer.sticky];return[this.vcRefs.header,this.vcRefs.data,this.vcRefs.footer].reduce((function(e,o,a){return e+function(e,t,r,n,i){if(void 0===i&&(i=[]),t.start>=t.end)return 0;if(t.start<r.start||t.end>r.end)throw Error("Error: attempted to measure an item that isn't rendered.");for(var o=t.start-r.start,a=0,s=t.end-t.start;s--;){var l=s+o;if(!i[l])for(var c=e.get(l),u=c?c.rootNodes.length:0;u--;)a+=Rt(n,c.rootNodes[u])}return a}(o,n[a],r[a],t,i[a])}),0)},e.prototype.destroy=function(){this.detachView(),this.destroyed.next(),this.destroyed.complete()},e.prototype.attachView=function(e){var t=this;e&&(this.ds=e,this._renderedRanges=[{start:0,end:0},this.cdkTable.viewChange.value,{start:0,end:0}],this.viewport.renderedRangeStream.pipe(o.takeUntil(this.destroyed)).subscribe((function(r){if(t.headerLength+t.footerLength===0)return t._renderedRanges=[{start:0,end:0},r,{start:0,end:0}],t.cdkTable.viewChange.next(r);t._renderedRanges=_t(r,t.metaRows[0],e.length);var n=m(t._renderedRanges,3),i=n[0],a=n[1],s=n[2];t.cdkTable.onRenderRows.pipe(o.take(1)).subscribe((function(){if(t.headerLength>0){for(var e=t.header.rows,r=t.header.rendered,n=t.header.sticky,o=0,a=t.header.sticky.length-1;o<a;o++)e[o].style.display=(r[o]=o>=i.start)||n[o]?null:"none";(r[o]=o>=i.start)||n[o]?t.grid.showHeader&&e[o]&&e[o].classList.remove("pbl-ngrid-row-visually-hidden"):e[o].classList.add("pbl-ngrid-row-visually-hidden")}if(t.footerLength>0)for(e=t.footer.rows,r=t.footer.rendered,n=t.footer.sticky,o=0,a=t.footer.sticky.length;o<a;o++)e[o].style.display=(r[o]=o<s.end)||n[o]?null:"none"})),t.cdkTable.viewChange.next(a)})),this.dataStream=e.onRenderDataChanging.pipe(o.takeUntil(this.destroyed),o.map((function(e){var r=e.data,n=t.metaRows=[t.header.rows.length,t.footer.rows.length];return new Array(r.length+n[0]+n[1])}))),e.onRenderedDataChanged.pipe(o.takeUntil(this.destroyed),o.map((function(){return e.length})),o.startWith(0),o.pairwise(),o.filter((function(e){var t=m(e,2);return t[0]!==t[1]}))).subscribe((function(e){var r=m(e,2),n=r[0],i=r[1];t.ngZone.onStable.pipe(o.take(1)).subscribe((function(){return t.viewport.onSourceLengthChange(n,i)}))})),this.viewport.attach(this))},e.prototype.detachView=function(){this.ds=void 0,this.viewport.detach()},e}();var Ot=function(e){function i(t,r,n,i,o,a,s,l,c,u){var d=e.call(this,t,r,n,i,o,c,u)||this;return d.injector=a,d.grid=s,d.extApi=l,d._minWidth=null,d._cachedRowDefs={header:new Set,footer:new Set},d.grid._cdkTable=d,d.trackBy=d.grid.trackBy,l.events.subscribe((function(e){"beforeInvalidateHeaders"===e.kind&&(d._lastSticky&&(d._lastSticky.queryCellElements("header","table","footer").forEach((function(e){return e.classList.remove("pbl-ngrid-sticky-start")})),d._lastSticky=void 0),d._lastStickyEnd&&(d._lastStickyEnd.queryCellElements("header","table","footer").forEach((function(e){return e.classList.remove("pbl-ngrid-sticky-end")})),d._lastStickyEnd=void 0))})),d}return g(i,e),Object.defineProperty(i.prototype,"_element",{get:function(){return this._elementRef.nativeElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"onRenderRows",{get:function(){return this.onRenderRows$||(this.onRenderRows$=new t.Subject),this.onRenderRows$.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"minWidth",{get:function(){return this._minWidth},set:function(e){this._minWidth=e||null,this._element.style.minWidth=e?e+"px":null},enumerable:!0,configurable:!0}),i.prototype.updateStickyColumnStyles=function(){var e=this;this._isStickyPending||(this._isStickyPending=!0,Promise.resolve().then((function(){e._isStickyPending=!1,e._updateStickyColumnStyles()})))},i.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this),this.onRenderRows$&&this.onRenderRows$.complete(),this.virtualScrollDestroy()},i.prototype.addClass=function(e){this._element.classList.add(e)},i.prototype.removeClass=function(e){this._element.classList.remove(e)},i.prototype.addHeaderRowDef=function(t){e.prototype.addHeaderRowDef.call(this,t),this._cachedRowDefs.header.add(t)},i.prototype.clearHeaderRowDefs=function(){var e,t,r=this._cachedRowDefs.header;try{for(var n=v(Array.from(r.values())),i=n.next();!i.done;i=n.next()){var o=i.value;this.removeHeaderRowDef(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}r.clear()},i.prototype.addFooterRowDef=function(t){e.prototype.addFooterRowDef.call(this,t),this._cachedRowDefs.footer.add(t)},i.prototype.clearFooterRowDefs=function(){var e,t,r=this._cachedRowDefs.footer;try{for(var n=v(Array.from(r.values())),i=n.next();!i.done;i=n.next()){var o=i.value;this.removeFooterRowDef(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}r.clear()},i.prototype.attachViewPort=function(){this.detachViewPort(),this.forOf=new Dt(this.extApi,this.injector.get(r.NgZone))},i.prototype.detachViewPort=function(){this.forOf&&(this.forOf.destroy(),this.forOf=void 0)},i.prototype.virtualScrollDestroy=function(){e.prototype.ngOnDestroy.call(this),this.detachViewPort()},i.prototype.updateRowDefCache=function(){this._cacheRowDefs()},i.prototype.renderRows=function(){e.prototype.renderRows.call(this);for(var t=this._rowOutlet.viewContainer,r=0,n=t.length;r<n;r++){t.get(r).context.gridInstance=this.grid}this.onRenderRows$&&this.onRenderRows$.next(this._rowOutlet)},i.prototype.syncRows=function(e){void 0===e&&(e=!1);for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n,i="boolean"==typeof e?e:"boolean"==typeof t[0]&&t.shift();switch(e){case"header":n=this._headerRowOutlet.viewContainer;break;case"data":n=this._rowOutlet.viewContainer;break;case"footer":n=this._footerRowOutlet.viewContainer;break;default:return this._changeDetectorRef.markForCheck(),void(i&&this._changeDetectorRef.detectChanges())}for(var o=t.length>0,a=o?t.length:n.length,s=0;s<a;s++){var l=n.get(o?t[s]:s);l&&(l.markForCheck(),i&&l.detectChanges())}},i.prototype.pblForceRenderDataRows=function(){try{this._forceRenderDataRows()}catch(e){this.multiTemplateDataRows=this.multiTemplateDataRows}},i.prototype._updateStickyColumnStyles=function(){for(var t,r,n=this.grid.columnApi.visibleColumns,i=0,o=n.length;i<o;i++)n[i].columnDef&&n[i].columnDef.sticky&&(t=n[i].columnDef);for(i=n.length-1;i>-1;i--)n[i].columnDef&&n[i].columnDef.stickyEnd&&(r=n[i].columnDef);this._lastSticky&&this._lastSticky.queryCellElements("header","table","footer").forEach((function(e){return e.classList.remove("pbl-ngrid-sticky-start")})),t&&t.queryCellElements("header","table","footer").forEach((function(e){return e.classList.add("pbl-ngrid-sticky-start")})),this._lastSticky=t,this._lastStickyEnd&&this._lastStickyEnd.queryCellElements("header","table","footer").forEach((function(e){return e.classList.remove("pbl-ngrid-sticky-end")})),r&&r.queryCellElements("header","table","footer").forEach((function(e){return e.classList.add("pbl-ngrid-sticky-end")})),this._lastStickyEnd=r,e.prototype.updateStickyColumnStyles.call(this)},i.decorators=[{type:r.Component,args:[{selector:"pbl-cdk-table",exportAs:"pblCdkTable",template:n.CDK_TABLE_TEMPLATE,host:{class:"pbl-cdk-table"},encapsulation:r.ViewEncapsulation.None,changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[".pbl-cdk-table{display:block}.pbl-ngrid-footer-row,.pbl-ngrid-header-row,.pbl-ngrid-row{display:flex;border-width:0 0 1px;border-style:solid;align-items:center;box-sizing:border-box;position:relative}.pbl-ngrid-footer-row::after,.pbl-ngrid-header-row::after,.pbl-ngrid-row::after{display:inline-block;min-height:inherit;content:''}.pbl-ngrid-cell,.pbl-ngrid-footer-cell,.pbl-ngrid-header-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.pbl-ngrid-header-cell.pbl-header-group-cell{display:flex;align-items:center}.pbl-ngrid-header-cell.pbl-header-group-cell.pbl-header-group-cell-placeholder{border:none}.pbl-ngrid-footer-cell,.pbl-ngrid-header-cell{position:relative}.pbl-ngrid-cell{cursor:default;outline:0}.pbl-ngrid-editable-cell{cursor:text}"]}]}],i.ctorParameters=function(){return[{type:r.IterableDiffers},{type:r.ChangeDetectorRef},{type:r.ElementRef},{type:String,decorators:[{type:r.Attribute,args:["role"]}]},{type:d.Directionality,decorators:[{type:r.Optional}]},{type:r.Injector},{type:Ue},{type:void 0,decorators:[{type:r.Inject,args:[D]}]},{type:void 0,decorators:[{type:r.Inject,args:[c.DOCUMENT]}]},{type:u.Platform}]},i}(n.CdkTable);var Pt=new Map,It=function(){function e(e){var t=this;this.grid=e,this.columns=[],this.entries=new WeakMap,this.ro=new i((function(e){requestAnimationFrame((function(){return t.onResize(e)}))}))}return e.get=function(t){var r=Pt.get(t);return r||(r=new e(t),Pt.set(t,r)),r},e.prototype.has=function(e){return-1!==this.columns.indexOf(e)},e.prototype.hasColumn=function(e){return this.columns.some((function(t){return t.column===e}))},e.prototype.add=function(e){this.entries.set(e.target,e),this.ro.observe(e.target),this.columns.push(e)},e.prototype.remove=function(e){this.ro.unobserve(e.target),this.entries.delete(e.target);var t=this.columns.indexOf(e);t>-1&&this.columns.splice(t,1),0===this.columns.length&&(this.ro.disconnect(),Pt.delete(this.grid))},e.prototype.onResize=function(e){var t,r,n,i,o=[];try{for(var a=v(e),s=a.next();!s.done;s=a.next()){var l=s.value,c=this.entries.get(l.target);c&&o.push(c)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}if(o.length>0){var u=!1;try{for(var d=v(o),h=d.next();!h.done;h=d.next()){var p=h.value;u=u||p.column.columnDef.isDragging,p.updateSize()}}catch(e){n={error:e}}finally{try{h&&!h.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}u||this.grid.resizeColumns(this.columns.map((function(e){return e.column})))}},e}();var Et=function(e){function t(t,r){var n=e.call(this,t.nativeElement)||this;return n.controller=It.get(r),n}return g(t,e),Object.defineProperty(t.prototype,"column",{get:function(){return this._column},set:function(e){this.attachColumn(e)},enumerable:!0,configurable:!0}),t.prototype.attachColumn=function(t){this.controller.hasColumn(t)?this._column=t:(e.prototype.attachColumn.call(this,t),this.updateSize())},t.prototype.ngAfterViewInit=function(){this.column&&this.controller.hasColumn(this.column)||this.controller.add(this)},t.prototype.ngOnDestroy=function(){this.controller.remove(this),this.detachColumn()},t.decorators=[{type:r.Directive,args:[{selector:"pbl-ngrid-cell[observeSize], pbl-ngrid-header-cell[observeSize]"}]}],t.ctorParameters=function(){return[{type:r.ElementRef},{type:Ue}]},t.propDecorators={column:[{type:r.Input,args:["observeSize"]}]},t}(be);var At=function(e,t){},Tt=function(){this.attach=At,this.detach=At,this.onContentScrolled=At,this.onDataLengthChanged=At,this.onContentRendered=At,this.onRenderedOffsetChanged=At,this.scrollToIndex=At};var Ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return g(t,e),t.prototype.addSample=function(t,r){this.rowInfo&&0===this.rowInfo.rowLength?this.reset():e.prototype.addSample.call(this,t,r)},t.prototype.setRowInfo=function(e){this.rowInfo=e},t}(p.ItemSizeAverager);var jt=function(e){function t(t,r,n){var i=e.call(this,t,r,n)||this;return i.itemSize=t,i}return g(t,e),t.prototype.attach=function(t){e.prototype.attach.call(this,this._ngridViewport=t)},t.prototype.onContentScrolled=function(){if(this._ngridViewport){var t=this._ngridViewport.getRenderedRange(),r=t.start,n=t.end,i=n-r,o=this._ngridViewport.getDataLength();i<0&&o<-i?(r=o-n,this._ngridViewport.setRenderedRange({start:r,end:n}),this._ngridViewport.setRenderedContentOffset(this.itemSize*r)):e.prototype.onContentScrolled.call(this)}},t}(h.FixedSizeVirtualScrollStrategy);var Wt=function(e){function t(t,r,n){void 0===n&&(n=new Ft);var i=e.call(this,t,r,n)||this;return i.averager=n,i}return g(t,e),t}(p.AutoSizeVirtualScrollStrategy);var Mt=["vScrollAuto","vScrollFixed","vScrollNone"];var Vt=function(){function e(e,t){this.grid=t,this._minBufferPx=100,this._maxBufferPx=200;var r=Mt.filter((function(t){return e.nativeElement.hasAttribute(t)}));if(r.length>1)throw new Error("Invalid vScroll instruction, only one value is allow: "+JSON.stringify(r));this._type=r[0]}return Object.defineProperty(e.prototype,"vScrollAuto",{get:function(){return this._vScrollAuto},set:function(e){this._vScrollAuto=a.coerceNumberProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vScrollFixed",{get:function(){return this._vScrollFixed},set:function(e){this._vScrollFixed=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minBufferPx",{get:function(){return this._minBufferPx},set:function(e){this._minBufferPx=a.coerceNumberProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxBufferPx",{get:function(){return this._maxBufferPx},set:function(e){this._maxBufferPx=a.coerceNumberProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wheelMode",{get:function(){return this._wheelMode},set:function(e){switch(e){case"passive":case"blocking":this._wheelMode=e;break;default:var t=a.coerceNumberProperty(e);t&&t>=1&&t<=60&&(this._wheelMode=t)}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){switch(this._type||(this._type="_vScrollFixed"in this?"vScrollFixed":"_vScrollAuto"in this?"vScrollAuto":"vScrollNone"),this.type){case"vScrollFixed":this._vScrollFixed||(this.vScrollFixed=this.grid.findInitialRowHeight()||48),this._scrollStrategy=new jt(this.vScrollFixed,this.minBufferPx,this.maxBufferPx);break;case"vScrollAuto":this._vScrollAuto||(this._vScrollAuto=this.grid.findInitialRowHeight()||48),this._scrollStrategy=new Wt(this.minBufferPx,this.maxBufferPx,new Ft(this._vScrollAuto));break;default:this._scrollStrategy=new Tt}},e.prototype.ngOnChanges=function(){if(this._scrollStrategy)switch(this.type){case"vScrollFixed":this._scrollStrategy.updateItemAndBufferSize(this.vScrollFixed,this.minBufferPx,this.maxBufferPx);break;case"vScrollAuto":this._scrollStrategy.updateBufferSize(this.minBufferPx,this.maxBufferPx)}},Object.defineProperty(e.prototype,"scrolledIndexChange",{get:function(){return this._scrollStrategy.scrolledIndexChange},set:function(e){this._scrollStrategy.scrolledIndexChange=e},enumerable:!0,configurable:!0}),e.prototype.attach=function(e){this._scrollStrategy.attach(e)},e.prototype.detach=function(){this._scrollStrategy.detach()},e.prototype.onContentScrolled=function(){this._scrollStrategy.onContentScrolled()},e.prototype.onDataLengthChanged=function(){this._scrollStrategy.onDataLengthChanged()},e.prototype.onContentRendered=function(){this._scrollStrategy.onContentRendered()},e.prototype.onRenderedOffsetChanged=function(){this._scrollStrategy.onRenderedOffsetChanged()},e.prototype.scrollToIndex=function(e,t){this._scrollStrategy.scrollToIndex(e,t)},e.decorators=[{type:r.Directive,args:[{selector:"pbl-ngrid[vScrollAuto], pbl-ngrid[vScrollFixed], pbl-ngrid[vScrollNone]",providers:[{provide:h.VIRTUAL_SCROLL_STRATEGY,useExisting:e}]}]}],e.ctorParameters=function(){return[{type:r.ElementRef},{type:Ue}]},e.propDecorators={vScrollAuto:[{type:r.Input}],vScrollFixed:[{type:r.Input}],minBufferPx:[{type:r.Input}],maxBufferPx:[{type:r.Input}],wheelMode:[{type:r.Input}]},e}();var Ht=function(e){function n(n,i,o,a,s,l,c,u,d){var h=e.call(this,n,i,o,s=function(e,t){if(!t&&e.has("virtualScroll")){var r=e.get("virtualScroll");"function"==typeof r.defaultStrategy&&(t=r.defaultStrategy())}return t||new Wt(100,200)}(a,s),l,c)||this;return h.cdr=i,h.pblScrollStrategy=s,h.grid=d,h.scrolling=new r.EventEmitter,h.scrollFrameRate=new r.EventEmitter,h.scrollHeight=0,h.ngeRenderedContentSize=0,h._totalContentWidth="",h._totalContentHeight="",h._totalContentSizeTransform="",h.offsetChange$=new t.Subject,h._isScrolling=!1,a.has("virtualScroll")&&(h.wheelModeDefault=a.get("virtualScroll").wheelMode),a.onUpdate("virtualScroll").pipe(I(h)).subscribe((function(e){return h.wheelModeDefault=e.curr.wheelMode})),h.enabled=s instanceof Vt?"vScrollNone"!==s.type:!(s instanceof Tt),u.extApi.setViewport(h),h.offsetChange=h.offsetChange$.asObservable(),h._minWidth$=d.columnApi.totalColumnWidthChange,h}return g(n,e),Object.defineProperty(n.prototype,"isScrolling",{get:function(){return this._isScrolling},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"wheelMode",{get:function(){return this.pblScrollStrategy.wheelMode||this.wheelModeDefault||"passive"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"innerWidth",{get:function(){return this.elementRef.nativeElement.querySelector(".cdk-virtual-scroll-inner-width").getBoundingClientRect().width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outerWidth",{get:function(){return this.elementRef.nativeElement.getBoundingClientRect().width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"innerHeight",{get:function(){return this.elementRef.nativeElement.querySelector(".cdk-virtual-scroll-inner-width").getBoundingClientRect().height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"outerHeight",{get:function(){return this.elementRef.nativeElement.getBoundingClientRect().height},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scrollWidth",{get:function(){return this.elementRef.nativeElement.scrollWidth},enumerable:!0,configurable:!0}),n.prototype.ngOnInit=function(){var t=this;this.enabled?e.prototype.ngOnInit.call(this):h.CdkScrollable.prototype.ngOnInit.call(this),this.ngZone.runOutsideAngular((function(){return t.initScrollWatcher()}))},n.prototype.ngAfterViewInit=function(){var e=this,t=this.grid;this.enabled&&t._cdkTable.attachViewPort(),this.scrolling.pipe(I(this)).subscribe((function(r){e._isScrolling=!!r,r?t.addClass("pbl-ngrid-scrolling"):t.removeClass("pbl-ngrid-scrolling")}))},n.prototype.ngOnDestroy=function(){e.prototype.ngOnDestroy.call(this),this.offsetChange$.complete(),I.kill(this)},n.prototype.setTotalContentSize=function(t){var r=this;e.prototype.setTotalContentSize.call(this,t),requestAnimationFrame((function(){r.scrollHeight=r.elementRef.nativeElement.scrollHeight,r.updateFiller(),r.cdr.markForCheck()}))},n.prototype.checkViewportSize=function(){var t=this.getViewportSize();e.prototype.checkViewportSize.call(this),t!==this.getViewportSize()&&this.updateFiller()},n.prototype.measureRenderedContentSize=function(){var t=e.prototype.measureRenderedContentSize.call(this);return"vertical"===this.orientation&&(t-=this.stickyRowHeaderContainer.offsetHeight+this.stickyRowFooterContainer.offsetHeight,this.enabled||(t+=this.outerHeight-this.innerHeight)),this.ngeRenderedContentSize=t},n.prototype.updateFiller=function(){this.measureRenderedContentSize(),this.grid.noFiller?this.pblFillerHeight=void 0:this.pblFillerHeight=this.getViewportSize()>=this.ngeRenderedContentSize?"calc(100% - "+this.ngeRenderedContentSize+"px)":void 0},n.prototype.onSourceLengthChange=function(e,t){this.checkViewportSize(),this.updateFiller()},n.prototype.attach=function(t){e.prototype.attach.call(this,t);var r=this.pblScrollStrategy instanceof Vt?this.pblScrollStrategy._scrollStrategy:this.pblScrollStrategy;r instanceof Wt&&r.averager.setRowInfo(t)},n.prototype.setRenderedContentOffset=function(t,r){var n=this;if(void 0===r&&(r="to-start"),e.prototype.setRenderedContentOffset.call(this,t,r),this.enabled&&this.offset!==t&&(this.offset=t,!this.isCDPending)){this.isCDPending=!0;this.ngZone.runOutsideAngular((function(){return Promise.resolve().then((function(){})).then((function(){n.isCDPending=!1,n.offsetChange$.next(n.offset)}))}))}},n.prototype.initScrollWatcher=function(){var e=this,t=0,r=this.measureScrollOffset();this.elementScrolled().subscribe((function(){if(0===t){var n=[performance.now(),0,0,0],i=e.measureScrollOffset();if(r===i)return;var o=r<i?1:-1;e.scrolling.next(o);var a=function(){var i=-n[0]+(n[0]=performance.now());i>5&&(n[1]+=i,n[2]+=1),-1===t?(t=0,r=e.measureScrollOffset(),e.scrolling.next(0)):(n[1]>499&&(n[3]+=n[1],n[1]=0,e.scrollFrameRate.emit(1e3/(n[3]/n[2]))),t=1===t?-1:1,requestAnimationFrame(a))};requestAnimationFrame(a)}t++}))},n.decorators=[{type:r.Component,args:[{selector:"pbl-cdk-virtual-scroll-viewport",template:'<p class="cdk-virtual-scroll-inner-width"></p>\n<ng-content select=".cdk-virtual-scroll-before-content-wrapper"></ng-content>\n\x3c!--\n  Wrap the rendered content in an element that will be used to offset it based on the scroll\n  position.\n--\x3e\n<div #contentWrapper [class.cdk-virtual-scroll-content-wrapper]="enabled" style="width: 100%" [style.minWidth.px]="_minWidth$ | async">\n  <ng-content></ng-content>\n</div>\n\n\x3c!--\n  Spacer used to force the scrolling container to the correct size for the *total* number of items\n  so that the scrollbar captures the size of the entire data set.\n--\x3e\n<div *ngIf="enabled" class="cdk-virtual-scroll-spacer"\n     [style.width]="_totalContentWidth" [style.height]="_totalContentHeight"\n     [style.transform]="_totalContentSizeTransform"></div>\n<div *ngIf="pblFillerHeight && enabled"\n    class="pbl-ngrid-space-fill"\n    [style.minWidth.px]="_minWidth$ | async"\n    [style.top.px]="ngeRenderedContentSize"\n    [style.height]="pblFillerHeight"></div>\n',host:{class:"cdk-virtual-scroll-viewport","[class.cdk-virtual-scroll-disabled]":"!enabled","[class.cdk-virtual-scroll-orientation-horizontal]":'orientation === "horizontal"',"[class.cdk-virtual-scroll-orientation-vertical]":'orientation === "vertical"'},encapsulation:r.ViewEncapsulation.None,changeDetection:r.ChangeDetectionStrategy.OnPush,styles:["pbl-cdk-virtual-scroll-viewport{display:block;position:relative;overflow:auto;contain:strict;transform:translateZ(0);will-change:scroll-position;-webkit-overflow-scrolling:touch}pbl-cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] pbl-cdk-virtual-scroll-viewport .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-inner-width{width:100%;height:100%;position:absolute;margin:0!important;padding:0!important}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:0}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:0}.cdk-virtual-scroll-spacer{position:absolute;top:0;left:0;height:1px;width:1px;transform-origin:0 0}[dir=rtl] .cdk-virtual-scroll-spacer{right:0;left:auto;transform-origin:100% 0}.pbl-ngrid-space-fill{position:absolute;left:0;width:100%}"]}]}],n.ctorParameters=function(){return[{type:r.ElementRef},{type:r.ChangeDetectorRef},{type:r.NgZone},{type:_},{type:void 0,decorators:[{type:r.Optional},{type:r.Inject,args:[h.VIRTUAL_SCROLL_STRATEGY]}]},{type:d.Directionality,decorators:[{type:r.Optional}]},{type:h.ScrollDispatcher},{type:k},{type:Ue}]},n.propDecorators={stickyRowHeaderContainer:[{type:r.Input}],stickyRowFooterContainer:[{type:r.Input}],scrolling:[{type:r.Output}],scrollFrameRate:[{type:r.Output}]},n}(h.CdkVirtualScrollViewport);var Nt=function(){function e(e,t,n){var i=this;this.scrolling=new r.EventEmitter;var o=t.events.subscribe((function(t){if("onInit"===t.kind){var r=e.viewport;r&&r.scrolling.subscribe((function(e){return n.run((function(){return i.scrolling.next(e)}))})),o.unsubscribe(),o=void 0}}))}return e.decorators=[{type:r.Directive,args:[{selector:"pbl-ngrid[scrolling]"}]}],e.ctorParameters=function(){return[{type:Ue},{type:k},{type:r.NgZone}]},e.propDecorators={scrolling:[{type:r.Output}]},e}();var zt=new r.InjectionToken("COMMON TABLE TEMPLATE INIT");function Lt(e){return[{provide:zt,multi:!0,useValue:e}]}var $t=function(){function e(t,r,n){var i,o,a,s;try{t.componentFactoryResolver&&r.getRoot()}catch(e){var l=t._parent;t._r3Injector=l}if(n)try{for(var c=v(n),u=c.next();!u.done;u=c.next()){var d=u.value;try{for(var h=(a=void 0,v(d)),p=h.next();!p.done;p=h.next()){var f=p.value;f.root&&(r=r.getRoot()),e.loadCommonTemplates(t,f.component,{registry:r,destroy:!0})}}catch(e){a={error:e}}finally{try{p&&!p.done&&(s=h.return)&&s.call(h)}finally{if(a)throw a.error}}}}catch(e){i={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(i)throw i.error}}}return e.forRoot=function(t,r){return{ngModule:e,providers:[{provide:C,useValue:t},_,Lt(r)]}},e.withCommon=function(t){return{ngModule:e,providers:Lt(t)}},e.loadCommonTemplates=function(e,t,n){var i=e.injector,o=n||{},a=o.registry,s=o.destroy;a&&(i=r.Injector.create({providers:[{provide:we,useValue:a.getRoot()}],parent:e.injector}));var l=e.componentFactoryResolver.resolveComponentFactory(t).create(i);return l.changeDetectorRef.detectChanges(),s&&e.onDestroy((function(){try{l.destroy()}catch(e){}})),l},e.decorators=[{type:r.NgModule,args:[{imports:[c.CommonModule,h.ScrollingModule,p.ScrollingModule,n.CdkTableModule],declarations:[ze,Le,Ot,dt,tt,wt,ct,at,lt,st,_e,Se,xe,Re,vt,mt,bt,Et,Ht,Vt,Nt,Ct,Ue],exports:[tt,wt,ct,at,lt,st,_e,Se,xe,Re,Nt,vt,mt,bt,Et,Vt,Ct,Ue]}]}],e.ctorParameters=function(){return[{type:r.NgModuleRef},{type:we},{type:Array,decorators:[{type:r.Inject,args:[zt]},{type:r.Optional},{type:r.Self}]}]},e}(),Bt={isPblColumn:he,isPblMetaColumn:re,isPblColumnGroup:ae,unrx:I};e.ColumnApi=He,e.EXT_API_TOKEN=D,e.NoVirtualScrollStrategy=Tt,e.PBL_NGRID_ROW_TEMPLATE=et,e.PEB_NGRID_CONFIG=C,e.PblColumn=pe,e.PblColumnFactory=fe,e.PblColumnGroup=ce,e.PblDataSource=Z,e.PblDataSourceAdapter=B,e.PblDataSourceFactory=Y,e.PblMetaColumn=ne,e.PblNgridCellDefDirective=xe,e.PblNgridCellStyling=wt,e.PblNgridComponent=Ue,e.PblNgridConfigService=_,e.PblNgridDataHeaderExtensionContext=ot,e.PblNgridFooterCellDefDirective=Se,e.PblNgridHeaderCellDefDirective=_e,e.PblNgridModule=$t,e.PblNgridMultiComponentRegistry=it,e.PblNgridMultiTemplateRegistry=nt,e.PblNgridNoDataRefDirective=lt,e.PblNgridPluginController=k,e.PblNgridRegistryService=we,e.PblNgridRowComponent=tt,e.PblNgridSingleTemplateRegistry=rt,e.PblPagingPaginator=q,e.PblRowContext=Pe,e.PblTokenPaginator=G,e.TableAutoSizeVirtualScrollStrategy=Wt,e.applySort=F,e.columnFactory=function(){return new fe},e.createDS=K,e.isPblColumn=he,e.isPblColumnGroup=ae,e.isPblMetaColumn=re,e.ngridPlugin=function(e,t){return e.runOnce&&e.runOnce(),x.set(e.id,y(y({},e),{target:t})),e.id},e.provideCommon=Lt,e.utils=Bt,e.ɵa=at,e.ɵb=st,e.ɵba=zt,e.ɵc=ct,e.ɵd=vt,e.ɵe=mt,e.ɵf=bt,e.ɵg=Ce,e.ɵh=Re,e.ɵi=dt,e.ɵj=Ct,e.ɵk=ze,e.ɵl=Le,e.ɵm=Ne,e.ɵn=le,e.ɵo=be,e.ɵp=De,e.ɵq=Ot,e.ɵr=Be,e.ɵs=Ge,e.ɵt=qe,e.ɵu=Et,e.ɵv=Ht,e.ɵw=Vt,e.ɵx=Nt,e.ɵy=I,e.ɵz=S,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=pebula-ngrid.umd.min.js.map