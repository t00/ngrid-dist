!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/material/sort"),require("@pebula/utils"),require("@pebula/ngrid"),require("@angular/common"),require("@angular/material/button")):"function"==typeof define&&define.amd?define("@pebula/ngrid-material/sort",["exports","@angular/core","@angular/material/sort","@pebula/utils","@pebula/ngrid","@angular/common","@angular/material/button"],r):r(((t=t||self).pebula=t.pebula||{},t.pebula["ngrid-material"]=t.pebula["ngrid-material"]||{},t.pebula["ngrid-material"].sort={}),t.ng.core,t.ng.material.sort,t.pebula.utils,t.pebula.ngrid,t.ng.common,t.ng.material.button)}(this,(function(t,r,e,o,n,i,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var s=function(t,r){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,r)};function c(t,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,r)}var l="matSort",u=function(){function t(t,r,e){var n=this;this.table=t,this.pluginCtrl=r,this.sort=e,this._removePlugin=r.setPlugin(l,this);var i="click";this.sort.sortChange.pipe(o.UnRx(this)).subscribe((function(t){n.onSort(t,i),i="click"}));var a=function(t){var r=t.column,e=t.sort?t.sort.order:void 0;if(n.sort&&r){if(n.sort.active===r.id&&n.sort.direction===(e||""))return;(o=n.sort.sortables.get(r.id))&&(i="ds",n.sort.active=void 0,o.start=e||"asc",o._handleClick())}else if(n.sort.active){var o;if(o=n.sort.sortables.get(n.sort.active)){if(!o.disableClear)for(var a=void 0;a=n.sort.getNextSortDirection(o);)n.sort.direction=a;i="ds",o._handleClick()}}};r.events.subscribe((function(r){if("onInvalidateHeaders"===r.kind){var e=n.sort&&n.sort.active;t.ds&&t.ds.sort&&(!t.ds.sort.column&&e?n.onSort({active:n.sort.active,direction:n.sort.direction||"asc"},i):t.ds.sort.column&&!e&&setTimeout((function(){return a(t.ds.sort)})))}"onDataSource"===r.kind&&(o.UnRx.kill(n,r.prev),n.sort&&n.sort.active&&n.onSort({active:n.sort.active,direction:n.sort.direction||"asc"},i),t.ds.sortChange.pipe(o.UnRx(n,r.curr)).subscribe((function(t){a(t)})))}))}return t.prototype.ngOnDestroy=function(){this._removePlugin(this.table)},t.prototype.onSort=function(t,r){var e=this.table,o=e.columnApi.visibleColumns.find((function(r){return r.id===t.active}));if("click"===r&&o&&o.sort){var n={},i="function"==typeof o.sort&&o.sort;t.direction&&(n.order=t.direction),i&&(n.sortFn=i);var a=e.ds.sort;if(o===a.column){var s=a.sort||{};if(n.order===s.order)return}e.ds.setSort(o,n)}},t.ctorParameters=function(){return[{type:n.PblNgridComponent},{type:n.PblNgridPluginController},{type:e.MatSort}]},t.decorators=[{type:r.Directive,args:[{selector:"pbl-ngrid[matSort]",exportAs:"pblMatSort"}]}],t.ctorParameters=function(){return[{type:n.PblNgridComponent},{type:n.PblNgridPluginController},{type:e.MatSort}]},t=function(t,r,e,o){var n,i=arguments.length,a=i<3?r:null===o?o=Object.getOwnPropertyDescriptor(r,e):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,r,e,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(r,e,a):n(r,e))||a);return i>3&&a&&Object.defineProperty(r,e,a),a}([n.NgridPlugin({id:l}),o.UnRx(),c("design:paramtypes",[n.PblNgridComponent,n.PblNgridPluginController,e.MatSort])],t)}();var d=function(t){function r(r){var e=t.call(this)||this;return e.cfr=r,e.name="sortContainer",e.kind="dataHeaderExtensions",e.projectContent=!0,e}return function(t,r){function e(){this.constructor=t}s(t,r),t.prototype=null===r?Object.create(r):(e.prototype=r.prototype,new e)}(r,t),r.prototype.shouldRender=function(t){return!!t.col.sort&&!!t.injector.get(e.MatSort,!1)},r.prototype.getFactory=function(t){return this.cfr.resolveComponentFactory(e.MatSortHeader)},r.prototype.onCreated=function(t,r){this.deregisterId(t,r.instance.id=t.col.id),r.changeDetectorRef.markForCheck()},r.prototype.deregisterId=function(t,r){var o=t.injector.get(e.MatSort),n=o.sortables.get(r);n&&o.deregister(n)},r}(n.PblNgridMultiComponentRegistry);var p=function(){function t(t,r){this.registry=t,t.addMulti("dataHeaderExtensions",new d(r))}return t.decorators=[{type:r.NgModule,args:[{imports:[i.CommonModule,a.MatButtonModule,e.MatSortModule,n.PblNgridModule],declarations:[u],exports:[u,e.MatSortModule],entryComponents:[e.MatSortHeader]}]}],t.ctorParameters=function(){return[{type:n.PblNgridRegistryService},{type:r.ComponentFactoryResolver}]},t}();t.PblNgridMatSortDirective=u,t.PblNgridMatSortModule=p,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=pebula-ngrid-material-sort.umd.min.js.map