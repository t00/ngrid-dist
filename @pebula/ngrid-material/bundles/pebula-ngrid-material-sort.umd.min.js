!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/material/sort"),require("@pebula/utils"),require("@pebula/ngrid"),require("@angular/common"),require("@angular/material/button")):"function"==typeof define&&define.amd?define("@pebula/ngrid-material/sort",["exports","@angular/core","@angular/material/sort","@pebula/utils","@pebula/ngrid","@angular/common","@angular/material/button"],e):e(((t=t||self).pebula=t.pebula||{},t.pebula["ngrid-material"]=t.pebula["ngrid-material"]||{},t.pebula["ngrid-material"].sort={}),t.ng.core,t.ng.material.sort,t.pebula.utils,t.pebula.ngrid,t.ng.common,t.ng.material.button)}(this,(function(t,e,r,o,n,i,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}var l="matSort",u=function(){function t(t,e,r){var n=this;this.table=t,this.pluginCtrl=e,this.sort=r,this._removePlugin=e.setPlugin(l,this);var i="click";this.sort.sortChange.pipe(o.UnRx(this)).subscribe((function(t){n.onSort(t,i),i="click"})),e.events.subscribe((function(e){"onInvalidateHeaders"===e.kind&&t.ds&&!t.ds.sort.column&&n.sort&&n.sort.active&&n.onSort({active:n.sort.active,direction:n.sort.direction||"asc"},i),"onDataSource"===e.kind&&(o.UnRx.kill(n,e.prev),n.sort&&n.sort.active&&n.onSort({active:n.sort.active,direction:n.sort.direction||"asc"},i),t.ds.sortChange.pipe(o.UnRx(n,e.curr)).subscribe((function(t){if(n.sort&&t.column){var e=t.sort||{};if(n.sort.active===t.column.id&&n.sort.direction===(e.order||""))return;(r=n.sort.sortables.get(t.column.id))&&(i="ds",n.sort.active=void 0,r.start=e.order||"asc",r._handleClick())}else if(n.sort.active){var r;if(r=n.sort.sortables.get(n.sort.active)){if(!r.disableClear)for(var o=void 0;o=n.sort.getNextSortDirection(r);)n.sort.direction=o;i="ds",r._handleClick()}}})))}))}return t.prototype.ngOnDestroy=function(){this._removePlugin(this.table)},t.prototype.onSort=function(t,e){var r=this.table,o=r.columnApi.visibleColumns.find((function(e){return e.id===t.active}));if("click"===e&&o&&o.sort){var n={},i="function"==typeof o.sort&&o.sort;t.direction&&(n.order=t.direction),i&&(n.sortFn=i);var a=r.ds.sort;if(o===a.column){var s=a.sort||{};if(n.order===s.order)return}r.ds.setSort(o,n)}},t.ctorParameters=function(){return[{type:n.PblNgridComponent},{type:n.PblNgridPluginController},{type:r.MatSort}]},t.decorators=[{type:e.Directive,args:[{selector:"pbl-ngrid[matSort]",exportAs:"pblMatSort"}]}],t.ctorParameters=function(){return[{type:n.PblNgridComponent},{type:n.PblNgridPluginController},{type:r.MatSort}]},t=function(t,e,r,o){var n,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(i<3?n(a):i>3?n(e,r,a):n(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a}([n.TablePlugin({id:l}),o.UnRx(),c("design:paramtypes",[n.PblNgridComponent,n.PblNgridPluginController,r.MatSort])],t)}();var d=function(t){function e(e){var r=t.call(this)||this;return r.cfr=e,r.name="sortContainer",r.kind="dataHeaderExtensions",r.projectContent=!0,r}return function(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}(e,t),e.prototype.shouldRender=function(t){return!!t.col.sort&&!!t.injector.get(r.MatSort,!1)},e.prototype.getFactory=function(t){return this.cfr.resolveComponentFactory(r.MatSortHeader)},e.prototype.onCreated=function(t,e){this.deregisterId(t,e.instance.id=t.col.id),e.changeDetectorRef.markForCheck()},e.prototype.deregisterId=function(t,e){var o=t.injector.get(r.MatSort),n=o.sortables.get(e);n&&o.deregister(n)},e}(n.PblNgridMultiComponentRegistry);var p=function(){function t(t,e){this.registry=t,t.addMulti("dataHeaderExtensions",new d(e))}return t.decorators=[{type:e.NgModule,args:[{imports:[i.CommonModule,a.MatButtonModule,r.MatSortModule,n.PblNgridModule],declarations:[u],exports:[u,r.MatSortModule],entryComponents:[r.MatSortHeader]}]}],t.ctorParameters=function(){return[{type:n.PblNgridRegistryService},{type:e.ComponentFactoryResolver}]},t}();t.PblNgridMatSortDirective=u,t.PblNgridMatSortModule=p,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=pebula-ngrid-material-sort.umd.min.js.map